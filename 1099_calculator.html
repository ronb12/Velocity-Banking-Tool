<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>1099 Contractor Tax Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8f9fa;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 950px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      margin-bottom: 10px;
      box-sizing: border-box;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background: #007bff;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
      font-size: 14px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #007bff;
      color: white;
    }
    .summary {
      margin-top: 20px;
      background: #e9f5ff;
      padding: 15px;
      border-radius: 6px;
    }
    .notice {
      font-size: 0.9em;
      color: #666;
      margin-bottom: 15px;
    }
    .export-buttons {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    #irsAlert {
      display: none;
      background: #fff3cd;
      padding: 10px;
      border-left: 5px solid #ffc107;
      margin-top: 10px;
      border-radius: 6px;
      font-size: 0.95em;
    }
    @media print {
      input, select, button, .notice, .export-buttons {
        display: none !important;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>1099 Contractor Tax Calculator</h1>
  <p class="notice">Select your tax year. Tax rates adjust automatically.</p>

  <label>Tax Year</label>
  <select id="taxYear">
    <option value="2025" selected>2025</option>
    <option value="2024">2024</option>
  </select>

  <label>Total Income ($)</label>
  <input type="number" id="income" placeholder="e.g. 1000" />

  <label>Expenses ($)</label>
  <input type="number" id="expenses" placeholder="e.g. 200" />

  <label>State</label>
  <select id="state"></select>

  <div id="irsAlert"></div>

  <button onclick="addEntry()">+ Add Entry</button>

  <div class="export-buttons">
    <button onclick="exportCSV()">üì§ Export to CSV</button>
    <button onclick="window.print()">üñ®Ô∏è Export to PDF</button>
    <button onclick="resetAll()">üîÑ Reset All Entries</button>
  </div>

  <table id="entryTable">
    <thead>
      <tr>
        <th>#</th>
        <th>Gross</th>
        <th>Expenses</th>
        <th>Net</th>
        <th>SE Tax</th>
        <th>Federal Tax</th>
        <th>State Tax</th>
        <th>Total Tax</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="summary">
    <strong>Year-to-Date Summary</strong>
    <p>Gross Income: $<span id="ytdGross">0.00</span></p>
    <p>Expenses: $<span id="ytdExpenses">0.00</span></p>
    <p>Net Income: $<span id="ytdNet">0.00</span></p>
    <p>Self-Employment Tax: $<span id="ytdSE">0.00</span></p>
    <p>Federal Tax: $<span id="ytdFederal">0.00</span></p>
    <p>State Tax: $<span id="ytdState">0.00</span></p>
    <hr>
    <p><strong>Total Tax Owed:</strong> $<span id="ytdTotal">0.00</span></p>
    <p><strong>Estimated Quarterly Payment:</strong> $<span id="ytdQuarterly">0.00</span></p>
  </div>
</div>

<script>
  const STORAGE_KEY = 'contractor_entries';

  const taxBrackets = {
    2024: income => {
      if (income <= 11000) return income * 0.1;
      if (income <= 44725) return 1100 + (income - 11000) * 0.12;
      if (income <= 95375) return 5147 + (income - 44725) * 0.22;
      if (income <= 182100) return 16290 + (income - 95375) * 0.24;
      return 37104 + (income - 182100) * 0.32;
    },
    2025: income => {
      if (income <= 11300) return income * 0.1;
      if (income <= 45675) return 1130 + (income - 11300) * 0.12;
      if (income <= 97050) return 5211 + (income - 45675) * 0.22;
      if (income <= 185000) return 16660 + (income - 97050) * 0.24;
      return 37996 + (income - 185000) * 0.32;
    }
  };

  const stateRates = {
    2024: { "California": 9.3, "Texas": 0, "New York": 6.85, "Florida": 0, "Illinois": 4.95 },
    2025: { "California": 9.3, "Texas": 0, "New York": 6.85, "Florida": 0, "Illinois": 4.95 }
  };

  const states = Object.keys(stateRates[2025]);
  const stateSelect = document.getElementById('state');
  states.forEach(state => {
    const option = document.createElement('option');
    option.value = state;
    option.textContent = state;
    stateSelect.appendChild(option);
  });

  function getStateRate(state, year) {
    return stateRates[year][state] || 0;
  }

  function getFederalTax(income, year) {
    return taxBrackets[year](income);
  }

  function showIRSAlert(netIncome) {
    const alertBox = document.getElementById('irsAlert');
    if (netIncome <= 400) {
      alertBox.innerHTML = `‚ö†Ô∏è <strong>IRS Filing Requirement:</strong><br>
      If your <strong>net self-employment income</strong> is over <strong>$400</strong> in a tax year, you are <strong>required to file taxes and pay self-employment tax</strong>, even if your income is below the standard deduction.  
      This rule applies to <strong>all years, including 2024 and 2025</strong>.`;
      alertBox.style.display = 'block';
    } else {
      alertBox.style.display = 'none';
    }
  }

  function addEntry() {
    const income = parseFloat(document.getElementById('income').value || 0);
    const expenses = parseFloat(document.getElementById('expenses').value || 0);
    const year = parseInt(document.getElementById('taxYear').value);
    const state = document.getElementById('state').value;
    const rate = getStateRate(state, year);

    if (income === 0) return;

    const net = Math.max(income - expenses, 0);
    const seTax = net * 0.153;
    const fedTax = getFederalTax(net, year);
    const stateTax = net * (rate / 100);
    const totalTax = seTax + fedTax + stateTax;

    showIRSAlert(net);

    const entries = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    entries.push({ income, expenses, net, seTax, fedTax, stateTax, totalTax });
    localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));

    renderEntries();
  }

  function renderEntries() {
    const tbody = document.querySelector('#entryTable tbody');
    const entries = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    tbody.innerHTML = '';
    let gross = 0, exp = 0, net = 0, se = 0, fed = 0, state = 0, total = 0;

    entries.forEach((e, i) => {
      tbody.innerHTML += `
        <tr>
          <td>${i + 1}</td>
          <td>$${e.income.toFixed(2)}</td>
          <td>$${e.expenses.toFixed(2)}</td>
          <td>$${e.net.toFixed(2)}</td>
          <td>$${e.seTax.toFixed(2)}</td>
          <td>$${e.fedTax.toFixed(2)}</td>
          <td>$${e.stateTax.toFixed(2)}</td>
          <td><strong>$${e.totalTax.toFixed(2)}</strong></td>
        </tr>`;
      gross += e.income;
      exp += e.expenses;
      net += e.net;
      se += e.seTax;
      fed += e.fedTax;
      state += e.stateTax;
      total += e.totalTax;
    });

    document.getElementById('ytdGross').textContent = gross.toFixed(2);
    document.getElementById('ytdExpenses').textContent = exp.toFixed(2);
    document.getElementById('ytdNet').textContent = net.toFixed(2);
    document.getElementById('ytdSE').textContent = se.toFixed(2);
    document.getElementById('ytdFederal').textContent = fed.toFixed(2);
    document.getElementById('ytdState').textContent = state.toFixed(2);
    document.getElementById('ytdTotal').textContent = total.toFixed(2);
    document.getElementById('ytdQuarterly').textContent = (total / 4).toFixed(2);
  }

  function exportCSV() {
    const entries = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    if (!entries.length) return alert("No entries to export.");
    let csv = "Entry #,Gross,Expenses,Net,SE Tax,Federal Tax,State Tax,Total Tax\n";
    entries.forEach((e, i) => {
      csv += `${i+1},${e.income},${e.expenses},${e.net},${e.seTax},${e.fedTax},${e.stateTax},${e.totalTax}\n`;
    });
    const blob = new Blob([csv], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "1099_tax_log.csv";
    a.click();
  }

  function resetAll() {
    if (confirm("Reset all entries? This cannot be undone.")) {
      localStorage.removeItem(STORAGE_KEY);
      renderEntries();
    }
  }

  window.onload = () => {
    renderEntries();
  };
</script>
</body>
</html>
