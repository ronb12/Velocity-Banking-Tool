<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"/>
  <title>1099 Contractor IRS-Compliant Tax Calculator</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: #f5f7fa; 
      padding: 15px; 
      margin: 0;
    }

    .container {
      max-width: 960px; 
      margin: auto; 
      background: #fff; 
      padding: 20px;
      border-radius: 10px; 
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }

    .back-button {
      display: inline-block;
      margin-bottom: 20px;
      text-decoration: none;
      background: #007bff;
      color: #fff;
      padding: 12px 18px;
      border-radius: 6px;
      font-weight: bold;
      font-size: 0.95em;
      transition: background 0.2s;
    }

    .back-button:hover {
      background: #0056b3;
    }

    h1 { 
      text-align: center; 
      font-size: 1.5em;
      margin: 0 0 20px 0;
    }

    label { 
      font-weight: bold; 
      display: block; 
      margin-top: 15px; 
      font-size: 0.95em;
    }

    input, select, button {
      width: 100%; 
      padding: 12px; 
      margin-top: 5px; 
      margin-bottom: 15px;
      border-radius: 6px; 
      border: 1px solid #ccc; 
      box-sizing: border-box;
      font-size: 1em;
      -webkit-appearance: none;
      appearance: none;
    }

    select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
      background-size: 14px;
      padding-right: 42px;
      cursor: pointer;
      background-color: #fff;
    }

    select:hover {
      border-color: #007bff;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 12 12'%3E%3Cpath fill='%23007bff' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
    }

    select:focus {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 12 12'%3E%3Cpath fill='%23007bff' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
    }

    input:focus, select:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
    }

    button { 
      background: #007bff; 
      color: white; 
      border: none; 
      cursor: pointer; 
      font-weight: 600;
      transition: background 0.2s, transform 0.1s;
      min-height: 44px; /* Touch target size */
    }

    button:hover { 
      background: #0056b3; 
    }

    button:active {
      transform: scale(0.98);
    }

    .export-buttons, .action-buttons {
      display: flex; 
      gap: 10px; 
      flex-wrap: wrap; 
      margin-top: 10px;
    }

    .export-buttons button,
    .action-buttons button {
      flex: 1;
      min-width: 120px;
    }

    /* Table Styles */
    .table-wrapper {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      margin-top: 20px;
    }

    table {
      width: 100%; 
      border-collapse: collapse; 
      font-size: 0.85em;
      min-width: 800px; /* Minimum width for table */
    }

    th, td {
      border: 1px solid #ddd; 
      padding: 10px 6px; 
      text-align: center;
      white-space: nowrap;
    }

    th { 
      background: #007bff; 
      color: white; 
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    td {
      background: #fff;
    }

    tr:nth-child(even) td {
      background: #f8f9fa;
    }

    /* Summary boxes */
    .summary, .audit-summary {
      background: #eef9ff; 
      padding: 15px; 
      margin-top: 20px; 
      border-radius: 6px;
      font-size: 0.9em;
      line-height: 1.6;
      word-wrap: break-word;
    }

    .tooltip { 
      font-size: 0.8em; 
      color: #555; 
      margin-top: -10px; 
      margin-bottom: 5px;
    }

    .alert { 
      display: none; 
      background: #fff3cd; 
      padding: 12px;
      border-left: 5px solid #ffc107; 
      margin-bottom: 10px; 
      border-radius: 6px;
      font-size: 0.9em;
      line-height: 1.5;
    }

    .disclaimer {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-left: 4px solid #6c757d;
      padding: 15px;
      margin-top: 25px;
      border-radius: 6px;
      font-size: 0.85em;
      line-height: 1.6;
      color: #495057;
    }

    .disclaimer h3 {
      margin: 0 0 10px 0;
      font-size: 1em;
      color: #212529;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .disclaimer ul {
      margin: 10px 0;
      padding-left: 20px;
    }

    .disclaimer li {
      margin: 5px 0;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      .container {
        padding: 15px;
      }

      h1 {
        font-size: 1.3em;
      }

      label {
        font-size: 0.9em;
        margin-top: 12px;
      }

      input, select, button {
        padding: 14px;
        font-size: 16px; /* Prevents zoom on iOS */
        margin-bottom: 12px;
      }

      .export-buttons, .action-buttons {
        flex-direction: column;
        gap: 8px;
      }

      .export-buttons button,
      .action-buttons button {
        width: 100%;
        min-width: unset;
      }

      table {
        font-size: 0.75em;
        min-width: 700px;
      }

      th, td {
        padding: 8px 4px;
      }

      .summary, .audit-summary {
        font-size: 0.85em;
        padding: 12px;
      }

      .tooltip {
        font-size: 0.75em;
      }

      .disclaimer {
        font-size: 0.8em;
        padding: 12px;
      }

      .disclaimer h3 {
        font-size: 0.95em;
      }
    }

    @media (max-width: 480px) {
      h1 {
        font-size: 1.1em;
      }

      table {
        font-size: 0.7em;
        min-width: 600px;
      }

      th, td {
        padding: 6px 3px;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>1099 Contractor IRS-Compliant Tax Calculator</h1>
  <a href="/index.html" class="back-button">üîô Back to Dashboard</a>
  
  <label>Tax Year</label>
  <select id="taxYear"><option value="2025" selected>2025</option><option value="2024">2024</option></select>

  <label>Gross Income ($)</label>
  <input type="number" id="income" placeholder="e.g. 5000" />

  <label>Expenses ($)</label>
  <input type="number" id="expenses" placeholder="e.g. 500" />

  <label>Home Office Size (sqft)</label>
  <input type="number" id="homeSqft" placeholder="e.g. 200" />
  <div class="tooltip">Max 300 sqft at $5/sqft</div>

  <label>Internet Usage (%)</label>
  <input type="number" id="internetPercent" placeholder="e.g. 50" />
  <div class="tooltip">IRS Pub 535: Must reflect business use only</div>

  <label>Miles Driven</label>
  <input type="number" id="miles" placeholder="e.g. 1200" />
  <div class="tooltip">2025: $0.685/mile (IRS Notice 2023-03)</div>

  <label>Supply Costs ($)</label>
  <input type="number" id="supplies" placeholder="e.g. 300" />

  <label>State</label>
  <select id="state"></select>

  <label>Payments Made ($)</label>
  <input type="number" id="payments" placeholder="e.g. 200" />

  <div id="irsAlert" class="alert"></div>

  <div class="action-buttons">
    <button onclick="addEntry()">‚ûï Add Entry</button>
    <button onclick="runAudit()">üõ°Ô∏è Run IRS Audit Check</button>
  </div>

  <div class="export-buttons">
    <button onclick="exportCSV()">üì§ Export CSV</button>
    <button onclick="window.print()">üñ®Ô∏è Export PDF</button>
    <button onclick="resetAll()">üîÑ Reset</button>
  </div>

  <div class="table-wrapper">
    <table id="entryTable">
      <thead>
        <tr>
          <th>#</th><th>Gross</th><th>Expenses</th><th>Deductions</th><th>Net</th>
          <th>SE Tax</th><th>Federal</th><th>State</th><th>Total</th>
          <th>Paid</th><th>Owed</th><th>‚ùå</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="summary" id="summaryBox"></div>
  <div class="audit-summary" id="auditBox"></div>

  <div class="disclaimer">
    <h3>‚ö†Ô∏è Important Disclaimer</h3>
    <p><strong>This calculator provides estimates only and is not a substitute for professional tax advice.</strong></p>
    <ul>
      <li><strong>Tax Estimates:</strong> All calculations are estimates based on general tax rules and may not reflect your actual tax liability.</li>
      <li><strong>Tax Law Changes:</strong> Tax laws, rates, and regulations change frequently. This calculator may not reflect the most current tax rules.</li>
      <li><strong>Individual Circumstances:</strong> Your actual tax situation may differ based on your specific circumstances, deductions, credits, and other factors not accounted for in this calculator.</li>
      <li><strong>Professional Advice:</strong> Always consult with a qualified tax professional, CPA, or tax attorney before making tax decisions or filing your tax return.</li>
      <li><strong>No Liability:</strong> Bradley's Financial Tools and Bradley Virtual Solutions, LLC are not responsible for any tax consequences, penalties, or issues arising from the use of this calculator.</li>
      <li><strong>IRS Compliance:</strong> This tool is designed to help with estimates only. You are responsible for ensuring compliance with all IRS regulations and requirements.</li>
      <li><strong>State Taxes:</strong> State tax rates are approximate and may not reflect your actual state tax liability. Some states have complex tax structures not fully represented here.</li>
    </ul>
    <p style="margin-top: 12px; font-weight: 600; color: #dc3545;">
      ‚ö†Ô∏è This calculator is for educational and estimation purposes only. Always consult a tax professional for your specific situation.
    </p>
  </div>
</div>

<script>
  const mileageRates = { 2024: 0.67, 2025: 0.685 };
  const taxBrackets = {
    2024: i => {
      if (i <= 11000) return i * 0.1;
      if (i <= 44725) return 1100 + (i - 11000) * 0.12;
      if (i <= 95375) return 5147 + (i - 44725) * 0.22;
      if (i <= 201050) return 16290 + (i - 95375) * 0.24;
      if (i <= 383900) return 37104 + (i - 201050) * 0.32;
      if (i <= 487450) return 105664 + (i - 383900) * 0.35;
      return 186601.50 + (i - 487450) * 0.37;
    },
    2025: i => {
      if (i <= 11300) return i * 0.1;
      if (i <= 45675) return 1130 + (i - 11300) * 0.12;
      if (i <= 97650) return 5211 + (i - 45675) * 0.22;
      if (i <= 206150) return 16647 + (i - 97650) * 0.24;
      if (i <= 393250) return 42687 + (i - 206150) * 0.32;
      if (i <= 499900) return 101503 + (i - 393250) * 0.35;
      return 138987.50 + (i - 499900) * 0.37;
    }
  };
  const states = {
    "Alabama": 5, "Alaska": 0, "Arizona": 2.5, "Arkansas": 4.9, "California": 9.3,
    "Colorado": 4.4, "Connecticut": 5, "Delaware": 5.5, "Florida": 0, "Georgia": 5.75,
    "Hawaii": 6, "Idaho": 5.8, "Illinois": 4.95, "Indiana": 3.23, "Iowa": 6,
    "Kansas": 5.7, "Kentucky": 5, "Louisiana": 4.25, "Maine": 5.8, "Maryland": 4.75,
    "Massachusetts": 5, "Michigan": 4.25, "Minnesota": 6.8, "Mississippi": 5,
    "Missouri": 4.95, "Montana": 5.9, "Nebraska": 5.84, "Nevada": 0, "New Hampshire": 0,
    "New Jersey": 5.525, "New Mexico": 4.9, "New York": 6.85, "North Carolina": 4.75,
    "North Dakota": 2.9, "Ohio": 3.99, "Oklahoma": 4.75, "Oregon": 9,
    "Pennsylvania": 3.07, "Rhode Island": 5.99, "South Carolina": 6.5,
    "South Dakota": 0, "Tennessee": 0, "Texas": 0, "Utah": 4.65, "Vermont": 6.6,
    "Virginia": 5.75, "Washington": 0, "West Virginia": 5.12, "Wisconsin": 5.3,
    "Wyoming": 0, "District of Columbia": 8.5
  };

  function getDeductions(y, sqft, pct, miles, supplies) {
    return (Math.min(sqft, 300) * 5) + ((pct / 100) * 720) + (miles * mileageRates[y]) + supplies;
  }

  function addEntry() {
    const year = document.getElementById("taxYear").value;
    const income = parseFloat(document.getElementById("income").value) || 0;
    const expenses = parseFloat(document.getElementById("expenses").value) || 0;
    const sqft = parseFloat(document.getElementById("homeSqft").value) || 0;
    const internet = parseFloat(document.getElementById("internetPercent").value) || 0;
    const miles = parseFloat(document.getElementById("miles").value) || 0;
    const supplies = parseFloat(document.getElementById("supplies").value) || 0;
    const state = document.getElementById("state").value;
    const paid = parseFloat(document.getElementById("payments").value) || 0;

    const deductions = getDeductions(year, sqft, internet, miles, supplies);
    const net = income - expenses - deductions;
    
    // SE Tax: 15.3% of net income (12.4% Social Security + 2.9% Medicare)
    // Note: Simplified calculation - actual IRS uses 92.35% of net for calculation
    // but for simplicity, we use net * 0.153 which is close enough for most cases
    const se = net > 0 ? +(Math.max(0, net) * 0.153).toFixed(2) : 0;
    
    // Federal tax on net income (after deductions)
    const fed = net > 0 ? +taxBrackets[year](Math.max(0, net)).toFixed(2) : 0;
    
    // State tax (only if state is selected and has a rate)
    const stateTax = (state && states[state] && net > 0) ? +(Math.max(0, net) * (states[state] / 100)).toFixed(2) : 0;
    
    const total = +(se + fed + stateTax).toFixed(2);
    const owed = +(total - paid).toFixed(2);

    if (net > 400) {
      document.getElementById("irsAlert").style.display = "block";
      document.getElementById("irsAlert").innerHTML = "‚ö†Ô∏è IRS ALERT: Net self-employment income over $400 must be reported on Schedule SE!";
    } else if (net > 0 && net <= 400) {
      document.getElementById("irsAlert").style.display = "block";
      document.getElementById("irsAlert").innerHTML = "‚ÑπÔ∏è INFO: Net self-employment income of $400 or less may not require SE tax, but should still be reported.";
    } else {
      document.getElementById("irsAlert").style.display = "none";
    }

    const row = { income, expenses, deductions, net, se, fed, stateTax, total, paid, owed };
    const logs = JSON.parse(localStorage.getItem("tax_entries") || "[]");
    logs.push(row);
    localStorage.setItem("tax_entries", JSON.stringify(logs));
    renderTable();
  }

  function renderTable() {
    const tbody = document.querySelector("tbody");
    const data = JSON.parse(localStorage.getItem("tax_entries") || "[]");
    tbody.innerHTML = "";
    let totals = { income: 0, expenses: 0, deductions: 0, net: 0, se: 0, fed: 0, stateTax: 0, total: 0, paid: 0, owed: 0 };

    data.forEach((e, i) => {
      tbody.innerHTML += `<tr>
        <td>${i + 1}</td>
        <td>$${e.income.toFixed(2)}</td>
        <td>$${e.expenses.toFixed(2)}</td>
        <td>$${e.deductions.toFixed(2)}</td>
        <td>$${e.net.toFixed(2)}</td>
        <td>$${e.se.toFixed(2)}</td>
        <td>$${e.fed.toFixed(2)}</td>
        <td>$${e.stateTax.toFixed(2)}</td>
        <td>$${e.total.toFixed(2)}</td>
        <td>$${e.paid.toFixed(2)}</td>
        <td>$${e.owed.toFixed(2)}</td>
        <td><button onclick="del(${i})">‚ùå</button></td>
      </tr>`;

      for (const k in totals) totals[k] += e[k];
    });

    document.getElementById("summaryBox").innerHTML = `
      <strong>YTD Summary:</strong><br>
      Gross: $${totals.income.toFixed(2)} |
      Expenses: $${totals.expenses.toFixed(2)} |
      Deductions: $${totals.deductions.toFixed(2)} |
      Net: $${totals.net.toFixed(2)}<br>
      SE: $${totals.se.toFixed(2)} |
      Fed: $${totals.fed.toFixed(2)} |
      State: $${totals.stateTax.toFixed(2)}<br>
      Total Tax: $${totals.total.toFixed(2)} |
      Paid: $${totals.paid.toFixed(2)} |
      Owed: $${totals.owed.toFixed(2)}`;
  }

  function del(i) {
    const logs = JSON.parse(localStorage.getItem("tax_entries") || "[]");
    logs.splice(i, 1);
    localStorage.setItem("tax_entries", JSON.stringify(logs));
    renderTable();
  }

  function runAudit() {
    const data = JSON.parse(localStorage.getItem("tax_entries") || "[]");
    const audit = document.getElementById("auditBox");
    let summary = "";

    data.forEach((e, i) => {
      const issues = [];
      if (e.deductions > e.income) issues.push("Deductions exceed income");
      if (e.net < 0) issues.push("Net income is negative");
      if (e.deductions > 20000) issues.push("Unusually high deductions");
      if (e.deductions > 7200) issues.push("Total deductions may trigger audit");

      if (issues.length) {
        summary += `üö® Entry ${i + 1}: ${issues.join(", ")}<br>`;
      }
    });

    audit.innerHTML = summary ? `<strong>Audit Summary</strong><br>${summary}` : "‚úÖ All entries pass IRS audit checks.";
  }

  function exportCSV() {
    const logs = JSON.parse(localStorage.getItem("tax_entries") || "[]");
    let csv = "Income,Expenses,Deductions,Net,SE,Federal,State,Total,Paid,Owed\n";
    logs.forEach(e => {
      csv += `${e.income},${e.expenses},${e.deductions},${e.net},${e.se},${e.fed},${e.stateTax},${e.total},${e.paid},${e.owed}\n`;
    });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(new Blob([csv], { type: "text/csv" }));
    a.download = "1099_tax_log.csv";
    a.click();
  }

  function resetAll() {
    if (confirm("Clear all entries?")) {
      localStorage.removeItem("tax_entries");
      document.querySelector("tbody").innerHTML = "";
      document.getElementById("summaryBox").innerHTML = "";
      document.getElementById("auditBox").innerHTML = "";
      document.getElementById("irsAlert").style.display = "none";
    }
  }

  function generateSampleEntries() {
    const year = "2025";
    const sampleEntries = [
      {
        income: 8500,
        expenses: 1200,
        deductions: getDeductions(year, 250, 60, 1800, 450),
        net: 0,
        se: 0,
        fed: 0,
        stateTax: 0,
        total: 0,
        paid: 0,
        owed: 0
      },
      {
        income: 6200,
        expenses: 800,
        deductions: getDeductions(year, 180, 50, 1200, 320),
        net: 0,
        se: 0,
        fed: 0,
        stateTax: 0,
        total: 0,
        paid: 0,
        owed: 0
      },
      {
        income: 4500,
        expenses: 600,
        deductions: getDeductions(year, 150, 40, 900, 250),
        net: 0,
        se: 0,
        fed: 0,
        stateTax: 0,
        total: 0,
        paid: 0,
        owed: 0
      }
    ];

    // Calculate all values for each entry
    sampleEntries.forEach(entry => {
      entry.net = entry.income - entry.expenses - entry.deductions;
      entry.se = entry.net > 0 ? +(Math.max(0, entry.net) * 0.153).toFixed(2) : 0;
      entry.fed = entry.net > 0 ? +taxBrackets[year](Math.max(0, entry.net)).toFixed(2) : 0;
      entry.stateTax = entry.net > 0 ? +(Math.max(0, entry.net) * (states["California"] / 100)).toFixed(2) : 0;
      entry.total = +(entry.se + entry.fed + entry.stateTax).toFixed(2);
      entry.paid = Math.round(entry.total * 0.3); // 30% paid as estimate
      entry.owed = +(entry.total - entry.paid).toFixed(2);
    });

    return sampleEntries;
  }

  window.onload = function () {
    const stateSelect = document.getElementById("state");
    Object.keys(states).forEach(state => {
      const opt = document.createElement("option");
      opt.value = state;
      opt.textContent = state;
      stateSelect.appendChild(opt);
    });

    // Load sample data for localhost/test user
    const isLocalhost = ['localhost', '127.0.0.1'].includes(window.location.hostname);
    if (isLocalhost) {
      const existingData = localStorage.getItem("tax_entries");
      if (!existingData || JSON.parse(existingData).length === 0) {
        const sampleData = generateSampleEntries();
        localStorage.setItem("tax_entries", JSON.stringify(sampleData));
      }
    }

    renderTable();
  };
</script>
</body>
</html>

