# Update addDebt to use window.tableBody and confirm tableBody is stored globally during onload

final_working_adddebt_fixed = re.sub(
    r'function\s+addDebt\s*\([^)]*\)\s*{.*?}',
    '''
function addDebt(name = '', balance = '', rate = '', payment = '') {
  const row = document.createElement("tr");
  row.innerHTML = `
    <td><input value="\${name}" oninput="calculateSummary()" /></td>
    <td><input type="number" value="\${balance}" oninput="calculateSummary()" /></td>
    <td><input type="number" value="\${rate}" oninput="calculateSummary()" /></td>
    <td><input type="number" value="\${payment}" oninput="calculateSummary()" /></td>
    <td class="monthsLeft">-</td>
    <td class="cfi">-</td>
    <td class="interest">-</td>
    <td class="priority">-</td>
    <td><button onclick="amortizeRow(this)">üìÑ</button></td>
    <td><button onclick="removeRow(this)" style="background:#dc3545;">‚ùå</button></td>
  `;
  window.tableBody.appendChild(row);
  calculateSummary();
  const firstInput = row.querySelector("input");
  if (firstInput) firstInput.focus();
}
''',
    html_with_tablebody_inside_onload,
    flags=re.DOTALL
)

# Save the confirmed functional version
final_fixed_scope_path = "/mnt/data/Debt_Tracker_AddDebt_FixedScope.html"
with open(final_fixed_scope_path, "w") as f:
    f.write(final_working_adddebt_fixed)

final_fixed_scope_path
