System.register(["./modulepreload-polyfill-legacy-CnvmjJHj.js","./preload-helper-legacy-B-gntM7F.js","./auth-legacy-CXkRVKZL.js","./sync-legacy-DONBmt1x.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"],function(e,t){"use strict";var o;return{setters:[null,e=>{o=e._},null,null,null,null,null],execute:function(){var e=document.createElement("style");e.textContent='html{height:100%;overflow-x:hidden;-webkit-overflow-scrolling:touch;position:relative;overscroll-behavior:none}@media (display-mode: standalone){html{height:100%;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior:none}body{height:100%;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior:none;position:relative}.dashboard{height:auto;min-height:100vh;overflow-x:hidden;-webkit-overflow-scrolling:touch;overscroll-behavior:none}}:root,[data-theme=blue]{--primary-color: #007bff;--secondary-color: #0056b3;--accent-color: #007bff;--danger-color: #dc3545;--warning-color: #ffc107;--success-color: #28a745;--info-color: #17a2b8;--bg-primary: linear-gradient(135deg, #f8fafc 0%, #e0e7ef 100%);--bg-secondary: #ffffff;--bg-card: #ffffff;--bg-hover: #f0f4f8;--text: #1e293b;--text-color: #1e293b;--text-muted: #64748b;--text-inverse: #ffffff;--border-color: #e2e8f0;--shadow: 0 2px 4px rgba(0,123,255,.1);--shadow-color: rgba(0,123,255,.1);--shadow-hover: 0 4px 8px rgba(0,123,255,.15);--transition: all .3s ease}[data-theme=pink]{--primary-color: #ff4b91;--secondary-color: #ff6b9d;--accent-color: #ff4b91;--danger-color: #ff6b6b;--warning-color: #ffd93d;--success-color: #51cf66;--info-color: #ff9ec5;--bg-primary: linear-gradient(135deg, #fffdee 0%, #fff5f5 100%);--bg-secondary: #ffffff;--bg-card: #fff5f5;--bg-hover: #ffeef0;--text: #333333;--text-color: #333333;--text-muted: #666666;--text-inverse: #ffffff;--border-color: #ffd6e0;--shadow: 0 2px 4px rgba(255,75,145,.2);--shadow-color: rgba(255,75,145,.2);--shadow-hover: 0 4px 8px rgba(255,75,145,.3);--transition: all .3s ease}[data-theme=green]{--primary-color: #28a745;--secondary-color: #20c997;--accent-color: #28a745;--danger-color: #dc3545;--warning-color: #ffc107;--success-color: #28a745;--info-color: #17a2b8;--bg-primary: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);--bg-secondary: #ffffff;--bg-card: #f0fdf4;--bg-hover: #dcfce7;--text: #1e293b;--text-color: #1e293b;--text-muted: #64748b;--text-inverse: #ffffff;--border-color: #bbf7d0;--shadow: 0 2px 4px rgba(40,167,69,.15);--shadow-color: rgba(40,167,69,.15);--shadow-hover: 0 4px 8px rgba(40,167,69,.25);--transition: all .3s ease}[data-theme=purple]{--primary-color: #6f42c1;--secondary-color: #8b5cf6;--accent-color: #6f42c1;--danger-color: #dc3545;--warning-color: #ffc107;--success-color: #28a745;--info-color: #a78bfa;--bg-primary: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);--bg-secondary: #ffffff;--bg-card: #faf5ff;--bg-hover: #f3e8ff;--text: #1e293b;--text-color: #1e293b;--text-muted: #64748b;--text-inverse: #ffffff;--border-color: #e9d5ff;--shadow: 0 2px 4px rgba(111,66,193,.15);--shadow-color: rgba(111,66,193,.15);--shadow-hover: 0 4px 8px rgba(111,66,193,.25);--transition: all .3s ease}[data-theme=orange]{--primary-color: #fd7e14;--secondary-color: #ff9500;--accent-color: #fd7e14;--danger-color: #dc3545;--warning-color: #ffc107;--success-color: #28a745;--info-color: #ffb84d;--bg-primary: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);--bg-secondary: #ffffff;--bg-card: #fff7ed;--bg-hover: #ffedd5;--text: #1e293b;--text-color: #1e293b;--text-muted: #64748b;--text-inverse: #ffffff;--border-color: #fed7aa;--shadow: 0 2px 4px rgba(253,126,20,.15);--shadow-color: rgba(253,126,20,.15);--shadow-hover: 0 4px 8px rgba(253,126,20,.25);--transition: all .3s ease}[data-theme=teal]{--primary-color: #20c997;--secondary-color: #14b8a6;--accent-color: #20c997;--danger-color: #dc3545;--warning-color: #ffc107;--success-color: #20c997;--info-color: #5eead4;--bg-primary: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%);--bg-secondary: #ffffff;--bg-card: #f0fdfa;--bg-hover: #ccfbf1;--text: #1e293b;--text-color: #1e293b;--text-muted: #64748b;--text-inverse: #ffffff;--border-color: #99f6e4;--shadow: 0 2px 4px rgba(32,201,151,.15);--shadow-color: rgba(32,201,151,.15);--shadow-hover: 0 4px 8px rgba(32,201,151,.25);--transition: all .3s ease}[data-theme=red]{--primary-color: #dc3545;--secondary-color: #c82333;--accent-color: #dc3545;--danger-color: #dc3545;--warning-color: #ffc107;--success-color: #28a745;--info-color: #e4606d;--bg-primary: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);--bg-secondary: #ffffff;--bg-card: #fef2f2;--bg-hover: #fee2e2;--text: #1e293b;--text-color: #1e293b;--text-muted: #64748b;--text-inverse: #ffffff;--border-color: #fecaca;--shadow: 0 2px 4px rgba(220,53,69,.15);--shadow-color: rgba(220,53,69,.15);--shadow-hover: 0 4px 8px rgba(220,53,69,.25);--transition: all .3s ease}[data-theme=blue-dark]{--primary-color: #4da3ff;--secondary-color: #20c997;--accent-color: #4da3ff;--danger-color: #ff6b6b;--warning-color: #ffd93d;--success-color: #51cf66;--info-color: #74c0fc;--bg-primary: linear-gradient(135deg, #1a1a1a 0%, #232946 100%);--bg-secondary: #2b2b2b;--bg-card: #2b2b2b;--bg-hover: #3a3a3a;--text: #f4f4f9;--text-color: #f4f4f9;--text-muted: #a0a0a0;--text-inverse: #1e293b;--border-color: #404040;--shadow: 0 2px 4px rgba(0,0,0,.3);--shadow-color: rgba(0,0,0,.3);--shadow-hover: 0 4px 8px rgba(0,0,0,.4);--transition: all .3s ease}body{font-family:Poppins,Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;background:var(--bg-primary);color:var(--text);margin:0;padding:0;letter-spacing:.01em;overflow-x:hidden;-webkit-overflow-scrolling:touch;min-height:100%;transition:background .3s ease,color .3s ease}@media (max-width: 768px){body{padding:1rem;overflow-x:hidden;-webkit-overflow-scrolling:touch}h1{font-size:1.5em}.container{width:100%;padding:1rem;justify-content:flex-start}}@media (max-width: 480px){body{padding:5px;overflow-x:hidden;-webkit-overflow-scrolling:touch}h1{font-size:1.2em}.container{padding:5px;justify-content:flex-start}}.container{display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:1200px;margin:auto}img{max-width:100%;height:auto}:root{--primary: var(--primary-color);--secondary: var(--secondary-color);--success: var(--success-color);--warning: var(--warning-color);--danger: var(--danger-color);--background: var(--bg-secondary);--card: var(--bg-card);--text: var(--text-color);--muted: var(--text-muted);--shadow: var(--shadow);--radius: 1.25rem;--transition: var(--transition);--card-background: var(--bg-card);--text-color: var(--text)}.loading{position:relative;pointer-events:none}.loading:after{content:"";position:absolute;top:50%;left:50%;width:24px;height:24px;margin:-12px 0 0 -12px;border:2px solid var(--primary);border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.notification{position:fixed;top:20px;right:20px;padding:15px 25px;border-radius:5px;background:var(--card-background);color:var(--text-color);box-shadow:var(--shadow);transform:translate(120%);transition:transform .3s ease;z-index:1000}.notification.show{transform:translate(0)}.notification.success{border-left:4px solid var(--secondary-color)}.notification.error{border-left:4px solid var(--danger-color)}.notification.warning{border-left:4px solid var(--warning-color)}input,select,textarea{width:100%;padding:10px;border:1px solid var(--border-color);border-radius:5px;background:var(--bg-card);color:var(--text-color);transition:var(--transition)}input:focus,select:focus,textarea:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(0,123,255,.2)}.card,.dashboard-tile{background:var(--bg-card);border-radius:10px;padding:20px;box-shadow:var(--shadow);margin:10px;display:inline-block;min-width:180px;font-weight:700;border-left:5px solid var(--primary-color);transition:var(--transition);color:var(--text-color)}.card:hover,.dashboard-tile:hover{transform:translateY(-2px);box-shadow:var(--shadow-hover);background:var(--bg-hover)}table{width:100%;border-collapse:collapse;margin:20px 0}th,td{padding:12px;text-align:left;border-bottom:1px solid var(--border-color)}th{background:var(--primary-color);color:#fff}tr:hover{background:rgba(52,152,219,.1)}@media (max-width: 768px){.card{padding:15px}button{width:100%;margin:5px 0}table{display:block;overflow-x:auto}}@keyframes slideIn{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.fade-in{animation:fadeIn .3s ease}.slide-in{animation:slideIn .3s ease}button{padding:10px 20px;border:none;border-radius:5px;background:var(--primary-color);color:#fff;cursor:pointer;transition:var(--transition);font-weight:500}button:hover{opacity:.9;transform:translateY(-1px)}button:active{transform:translateY(0)}button:disabled{opacity:.5;cursor:not-allowed}.tile-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem;margin:3rem auto;max-width:1200px}.tile{display:flex;flex-direction:column;align-items:center;justify-content:center;background:var(--card-background);color:var(--text-color);border-radius:16px;box-shadow:var(--shadow);padding:2.5rem 2rem;text-decoration:none;font-weight:500;transition:var(--transition);border:1px solid var(--border-color);position:relative;overflow:hidden;min-height:200px}.tile:before{content:"";position:absolute;top:0;left:0;width:100%;height:4px;background:linear-gradient(90deg,var(--primary-color),var(--secondary-color));opacity:.8}.tile:hover{transform:translateY(-4px);box-shadow:var(--shadow-hover)}.tile-icon{font-size:2.75rem;margin-bottom:1.25rem;display:block;background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1}.tile-title{font-size:1.35rem;font-weight:600;text-align:center;color:var(--text-color);margin-bottom:.5rem}.tile-description{font-size:.95rem;color:var(--text-muted);text-align:center;line-height:1.5}.subtitle{font-size:1.25rem;color:var(--text-muted);margin:1rem 0 2rem;font-weight:500;margin:.5rem 0;opacity:.8}header h1{font-size:2.75rem;font-weight:800;margin:0;background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:-.02em}.dashboard-tile h3{margin:0 0 .75rem;font-size:1.35rem;font-weight:600;color:var(--text-color)}.dashboard-tile p{margin:0;font-size:1.1rem;color:var(--text-muted);line-height:1.5}.recent-activity{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border-color);background-color:var(--card-background);padding:1.5rem;border-radius:var(--border-radius);box-shadow:0 2px 4px var(--shadow-color)}.recent-activity h2{font-size:1.5rem;margin-bottom:1rem;color:var(--text-color)}#activityList{display:grid;gap:1rem}.dashboard{max-width:1050px;margin:0 auto;padding:1.5rem .5rem 2rem;overflow-x:hidden}header{background:rgba(255,255,255,.85);backdrop-filter:blur(8px);border-radius:1.5rem;box-shadow:0 8px 32px rgba(37,99,235,.1);padding:1.2rem 2rem 1rem;margin-bottom:2rem;display:flex;align-items:center;justify-content:space-between;transition:background .3s}.header-title{font-size:1.6rem;font-weight:700;letter-spacing:-.5px;display:flex;align-items:center;gap:.7rem}.header-controls{display:flex;gap:1.25rem;align-items:center}.control-btn{background:rgba(255,255,255,.15);color:#fff;border:none;padding:.7rem 1.5rem;border-radius:999px;font-weight:600;font-size:1rem;cursor:pointer;transition:background var(--transition),color var(--transition);box-shadow:0 2px 8px rgba(0,0,0,.04)}.control-btn:hover{background:rgba(255,255,255,.25)}.user-menu{display:flex;align-items:center;gap:1rem}.user-email{color:var(--text-color);font-weight:500}.dashboard-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.2rem;margin-bottom:2rem}.stat-tile{background:var(--bg-card);border-radius:1.25rem;box-shadow:var(--shadow);padding:1.2rem 1.1rem;display:flex;align-items:center;gap:1.1rem;border-left:5px solid var(--primary);min-height:90px;transition:var(--transition);position:relative;overflow:hidden;backdrop-filter:blur(4px);color:var(--text-color)}.stat-tile[data-type=success]{border-left-color:var(--success)}.stat-tile[data-type=warning]{border-left-color:var(--warning)}.stat-tile[data-type=danger]{border-left-color:var(--danger)}.stat-tile:hover{box-shadow:var(--shadow-hover);transform:translateY(-2px) scale(1.015);background:var(--bg-hover)}.stat-icon{font-size:1.7rem;color:var(--primary-color);background:var(--bg-hover);border-radius:50%;padding:.7rem;display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow)}.stat-content h3{margin:0 0 .2rem;font-size:1.05rem;color:var(--muted);font-weight:600}.stat-value{font-size:1.45rem;font-weight:700;color:var(--primary);margin:0}.tools-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.2rem;margin-bottom:2.2rem}.tool-card{background:var(--bg-card);border-radius:1.25rem;box-shadow:var(--shadow);text-decoration:none;color:var(--text-color);padding:1.2rem 1.1rem;display:flex;flex-direction:column;align-items:center;transition:var(--transition);border:none;min-height:120px;overflow:hidden;backdrop-filter:blur(4px)}.tool-card:hover{box-shadow:var(--shadow-hover);transform:translateY(-2px) scale(1.015);background:var(--bg-hover)}.tool-icon{font-size:1.5rem;margin-bottom:.7rem;color:var(--primary-color);background:var(--bg-hover);border-radius:50%;padding:.7rem;display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow)}.tool-card h3{margin:0 0 .2rem;font-size:1.05rem;font-weight:600}.tool-card p{margin:0;font-size:.98rem;color:var(--muted)}.control-btn,.tool-card,.stat-tile{transition:box-shadow .2s,transform .2s,background .2s}@media (max-width: 900px){.dashboard-stats,.tools-grid{grid-template-columns:1fr 1fr}}@media (max-width: 600px){.dashboard{padding:.5rem .1rem}header{flex-direction:column;align-items:flex-start;padding:1rem .7rem .7rem}.dashboard-stats,.tools-grid{grid-template-columns:1fr;gap:.7rem}}.session-timeout{position:fixed;bottom:2rem;right:2rem;background:var(--card);padding:1.25rem 2rem;border-radius:var(--radius);box-shadow:0 4px 16px rgba(37,99,235,.12);z-index:1000;border:1px solid #e0e7ff}.timeout-content{display:flex;align-items:center;gap:1.25rem}.timeout-content p{margin:0;font-weight:500}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spinner{display:inline-block;width:1.2em;height:1.2em;border:2px solid #cbd5e1;border-top:2px solid #2563eb;border-radius:50%;animation:spin 1s linear infinite;vertical-align:middle}.profile-modal{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(30,41,59,.25);z-index:2000;display:flex;align-items:center;justify-content:center;animation:fadeIn .2s;overflow-y:auto;overflow-x:visible;padding:2rem}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.profile-modal-content{background:#fff;border-radius:1.5rem;box-shadow:0 8px 32px rgba(37,99,235,.12);padding:2.5rem 2.5rem 2rem;min-width:320px;max-width:95vw;max-height:95vh;min-height:600px;position:relative;display:flex;flex-direction:column;align-items:center;animation:fadeIn .2s;overflow-y:auto;overflow-x:visible}body.dark .profile-modal-content{background:#232946;color:#f4f4f9}.close-profile-modal{position:absolute;top:1.2rem;right:1.2rem;background:none;border:none;font-size:2rem;color:#64748b;cursor:pointer;transition:color .2s}.close-profile-modal:hover{color:#ef4444}.profile-header{display:flex;align-items:center;gap:1.2rem;margin-bottom:1.5rem}.profile-metrics{width:100%;display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;margin-bottom:1.5rem}.profile-metric{background:#f8fafc;border:1px solid #e2e8f0;border-radius:.75rem;padding:1rem 1.25rem;display:flex;flex-direction:column;gap:.25rem}.metric-label{font-size:.8rem;font-weight:600;letter-spacing:.05em;text-transform:uppercase;color:#64748b}.metric-value{font-size:1.25rem;font-weight:700;color:#0f172a}.profile-avatar-large{width:64px;height:64px;border-radius:50%;object-fit:cover;box-shadow:0 2px 8px rgba(37,99,235,.1)}body.dark .profile-metric{background:#2f3a5a;border-color:#3f4a6c}body.dark .metric-label{color:#cbd5f5}body.dark .metric-value{color:#f8f4f9}.profile-header h2{margin:0 0 .2rem;font-size:1.35rem;font-weight:700}.profile-header p{margin:0;color:#64748b;font-size:1rem}.avatar-container{position:relative;display:inline-block}.avatar-upload-btn{position:absolute;bottom:-5px;right:-5px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:3px solid white;width:40px;height:40px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px rgba(102,126,234,.4);transition:all .3s ease;z-index:10}.avatar-upload-btn:hover{transform:scale(1.1);box-shadow:0 4px 12px rgba(102,126,234,.4)}.upload-icon{font-size:18px}.profile-settings{margin:2rem 0;padding:1.5rem;background:#f8fafc;border-radius:.75rem;min-height:400px;width:100%;border:1px solid #e2e8f0}.profile-settings h3{margin:0 0 1rem;font-size:1.1rem;font-weight:700;color:#1e293b}.settings-group{display:flex;flex-direction:column;gap:1rem}.setting-item{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.theme-dropdown-wrapper{position:relative;width:100%;max-width:250px}.theme-dropdown-button{width:100%;padding:.75rem 2.5rem .75rem 1rem;border:2px solid var(--border-color);border-radius:.625rem;background:#fff;color:#1e293b;font-size:.9375rem;font-weight:500;cursor:pointer;transition:all .2s ease;display:flex;justify-content:space-between;align-items:center;text-align:left;position:relative;box-sizing:border-box}.theme-dropdown-button:hover{border-color:var(--primary-color);background:#f8fafc;box-shadow:0 2px 8px rgba(0,0,0,.08)}.theme-dropdown-button.active{border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(0,123,255,.1)}.theme-dropdown-selected{display:flex;align-items:center;gap:.75rem;flex:1;min-width:0}.theme-dropdown-swatch{width:28px;height:28px;border-radius:6px;border:2px solid rgba(0,0,0,.1);box-shadow:0 1px 3px rgba(0,0,0,.1);flex-shrink:0;display:block}.theme-dropdown-text{flex:1;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.theme-dropdown-arrow{position:absolute;right:1rem;font-size:.75rem;color:#64748b;pointer-events:none;transition:transform .2s ease}.theme-dropdown-button.active .theme-dropdown-arrow{transform:rotate(180deg)}.theme-dropdown-menu{position:absolute;top:calc(100% + .5rem);left:0;right:0;background:#fff;border:2px solid var(--border-color);border-radius:.625rem;box-shadow:0 4px 16px rgba(0,0,0,.12);z-index:1000;max-height:320px;overflow-y:auto;overflow-x:hidden;display:none;margin-top:.25rem}.theme-dropdown-menu.show{display:block}.theme-dropdown-menu::-webkit-scrollbar{width:6px}.theme-dropdown-menu::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.theme-dropdown-menu::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.theme-dropdown-menu::-webkit-scrollbar-thumb:hover{background:#94a3b8}.theme-dropdown-item{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;cursor:pointer;transition:background .15s ease;border-bottom:1px solid #f1f5f9;position:relative}.theme-dropdown-item:last-child{border-bottom:none}.theme-dropdown-item:hover{background:#f8fafc}.theme-dropdown-item.active{background:#e0f2fe;font-weight:600}.theme-dropdown-item-swatch{width:28px;height:28px;border-radius:6px;border:2px solid rgba(0,0,0,.1);box-shadow:0 1px 3px rgba(0,0,0,.1);flex-shrink:0;display:block}.theme-dropdown-item.active .theme-dropdown-item-swatch{border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(0,123,255,.15)}.theme-dropdown-item-icon{font-size:1.1rem;width:20px;text-align:center;flex-shrink:0}.theme-dropdown-item-name{flex:1;font-size:.9375rem;color:#1e293b;font-weight:500}.theme-dropdown-item.active .theme-dropdown-item-name{color:var(--primary-color);font-weight:600}.theme-dropdown-item-check{color:var(--primary-color);font-weight:700;font-size:1rem;flex-shrink:0;width:20px;text-align:center}[data-theme=blue-dark] .theme-dropdown-button{background:#2b2b2b;color:#f4f4f9;border-color:#404040}[data-theme=blue-dark] .theme-dropdown-button:hover{background:#3a3a3a}[data-theme=blue-dark] .theme-dropdown-menu{background:#2b2b2b;border-color:#404040}[data-theme=blue-dark] .theme-dropdown-item{border-bottom-color:#404040;color:#f4f4f9}[data-theme=blue-dark] .theme-dropdown-item:hover{background:#3a3a3a}[data-theme=blue-dark] .theme-dropdown-item.active{background:#1e3a5f}[data-theme=blue-dark] .theme-dropdown-item-name{color:#f4f4f9}@media (max-width: 768px){.theme-dropdown-wrapper{max-width:100%}.theme-dropdown-button{padding:.875rem 2.5rem .875rem 1rem}.theme-dropdown-menu{max-height:280px}}.setting-label{display:flex;align-items:center;gap:.75rem;cursor:pointer;flex:1}.setting-icon{font-size:1.2rem;width:24px;text-align:center}.setting-text{font-weight:600;color:#374151;font-size:.95rem}.toggle-switch{position:relative;display:inline-block;width:48px;height:24px}.toggle-switch input{opacity:0;width:0;height:0}.toggle-slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#cbd5e1;transition:.3s;border-radius:24px}.toggle-slider:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.3s;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}input:checked+.toggle-slider{background:linear-gradient(135deg,#667eea,#764ba2)}input:checked+.toggle-slider:before{transform:translate(24px)}.profile-actions{margin-top:2rem;padding-top:1.5rem;border-top:1px solid #e2e8f0;display:flex;flex-direction:column;gap:.75rem}.settings-btn{width:100%;background:linear-gradient(135deg,#6b7280,#4b5563);color:#fff;border:none;padding:.875rem 1.5rem;border-radius:.75rem;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:.75rem;box-shadow:0 4px 12px rgba(107,114,128,.3)}.settings-btn:hover{background:linear-gradient(135deg,#4b5563,#374151);transform:translateY(-2px);box-shadow:0 6px 20px rgba(107,114,128,.4)}.settings-icon{font-size:1.1rem}.settings-text{font-weight:600;font-size:.95rem}body.dark .profile-settings{background:#1f2937;border-color:#374151}body.dark .profile-settings h3{color:#f4f4f9}body.dark .setting-text{color:#d1d5db}@keyframes slideIn{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}@keyframes slideOut{0%{transform:translate(0);opacity:1}to{transform:translate(100%);opacity:0}}.logout-btn{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.75rem 1.5rem;font-size:.9rem;font-weight:600;box-shadow:0 4px 12px rgba(239,68,68,.3);text-shadow:0 1px 2px rgba(0,0,0,.15)}.logout-btn:hover{background:linear-gradient(135deg,#dc2626,#b91c1c);transform:translateY(-2px);box-shadow:0 6px 20px rgba(239,68,68,.4)}.logout-btn:active{transform:translateY(0);box-shadow:0 2px 8px rgba(239,68,68,.3)}.logout-icon{font-size:1.2rem}.logout-text{font-weight:700;font-size:1rem;letter-spacing:.025em}body.dark .profile-actions{border-top:1px solid #374151}body.dark .logout-btn{background:linear-gradient(135deg,#ef4444,#dc2626);box-shadow:0 4px 12px rgba(239,68,68,.4)}body.dark .logout-btn:hover{background:linear-gradient(135deg,#dc2626,#b91c1c);box-shadow:0 6px 20px rgba(239,68,68,.5)}body.dark{background:#0f172a;color:#f1f5f9}body.dark .dashboard{background:#0f172a}body.dark header{background:#1e293b;color:#f1f5f9}body.dark .stat-tile,body.dark .tool-card{background:#1e293b;color:#f1f5f9}body.dark .tool-card:hover{background:#334155}.financial-education{margin-top:2rem;padding:1.5rem;background:var(--bg-card);border-radius:1rem;box-shadow:var(--shadow)}.tip-card{background:var(--bg-card);border-radius:.75rem;padding:1.5rem;margin-bottom:1rem;box-shadow:var(--shadow)}.tip-navigation{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;gap:1rem}.tip-nav-btn{padding:.5rem 1rem;border:1px solid var(--border-color);border-radius:.5rem;background:var(--bg-card);color:var(--text);cursor:pointer;transition:var(--transition)}.tip-nav-btn:hover{background:var(--bg-hover);border-color:var(--primary-color)}.nav-dots{display:flex;gap:.5rem;justify-content:center;flex:1}.nav-dot{width:8px;height:8px;border-radius:50%;background:var(--border-color);cursor:pointer;transition:var(--transition)}.nav-dot.active{background:var(--primary-color);transform:scale(1.2)}@media (max-width: 768px){.profile-modal{padding:1rem}.profile-modal-content{padding:1.5rem;min-height:auto}.profile-metrics{grid-template-columns:1fr}}.recommendations-section{margin-top:3rem;width:100%}.recommendations{padding:2.5rem;background:linear-gradient(135deg,rgba(255,255,255,.95),rgba(249,250,251,.95));border-radius:1.5rem;box-shadow:0 8px 32px rgba(37,99,235,.12),0 2px 8px rgba(0,0,0,.04);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.8);position:relative;overflow:hidden}.recommendations:before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,#667eea,#764ba2,#f093fb);opacity:.8}.recommendations h2{margin:0 0 2rem;font-size:1.875rem;font-weight:800;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-align:center;letter-spacing:-.02em}#recommendationsContainer,.recommendation-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.recommendation-card{background:#fff;border-radius:1.25rem;padding:2rem;box-shadow:0 4px 16px rgba(0,0,0,.08),0 1px 4px rgba(0,0,0,.04);display:flex;flex-direction:column;gap:1.25rem;transition:all .4s cubic-bezier(.4,0,.2,1);border:1px solid rgba(226,232,240,.8);position:relative;overflow:hidden}.recommendation-card:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#667eea,#764ba2);transform:scaleX(0);transform-origin:left;transition:transform .4s cubic-bezier(.4,0,.2,1)}.recommendation-card:hover{transform:translateY(-4px);box-shadow:0 12px 32px rgba(102,126,234,.2),0 4px 12px rgba(0,0,0,.1);border-color:rgba(102,126,234,.3)}.recommendation-card:hover:before{transform:scaleX(1)}.recommendation-card:nth-child(1) .recommendation-icon{background:linear-gradient(135deg,#667eea,#764ba2)}.recommendation-card:nth-child(2) .recommendation-icon{background:linear-gradient(135deg,#f093fb,#f5576c)}.recommendation-card:nth-child(3) .recommendation-icon{background:linear-gradient(135deg,#4facfe,#00f2fe)}.recommendation-card:nth-child(4) .recommendation-icon{background:linear-gradient(135deg,#43e97b,#38f9d7)}.recommendation-icon{font-size:2.5rem;width:72px;height:72px;display:flex;align-items:center;justify-content:center;border-radius:1rem;flex-shrink:0;box-shadow:0 4px 12px rgba(0,0,0,.15);transition:all .4s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.recommendation-icon:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background:linear-gradient(135deg,rgba(255,255,255,.3) 0%,transparent 100%);opacity:0;transition:opacity .4s}.recommendation-card:hover .recommendation-icon{transform:scale(1.1) rotate(5deg);box-shadow:0 8px 20px rgba(0,0,0,.25)}.recommendation-card:hover .recommendation-icon:before{opacity:1}.recommendation-content{flex:1;display:flex;flex-direction:column;gap:.75rem}.recommendation-content h3{margin:0;font-size:1.375rem;font-weight:700;color:var(--text-color, #1e293b);letter-spacing:-.01em;line-height:1.3}.recommendation-content p{margin:0;color:#64748b;line-height:1.7;font-size:.9375rem;flex:1}.recommendation-link{display:inline-flex;align-items:center;gap:.5rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:.75rem 1.5rem;border-radius:.75rem;text-decoration:none;font-weight:600;font-size:.9375rem;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 2px 8px rgba(102,126,234,.3);align-self:flex-start;margin-top:auto}.recommendation-link:after{content:"â†’";transition:transform .3s cubic-bezier(.4,0,.2,1)}.recommendation-link:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(102,126,234,.4);background:linear-gradient(135deg,#764ba2,#667eea)}.recommendation-link:hover:after{transform:translate(4px)}.recommendation-card:nth-child(1) .recommendation-link{background:linear-gradient(135deg,#667eea,#764ba2);box-shadow:0 2px 8px rgba(102,126,234,.3)}.recommendation-card:nth-child(2) .recommendation-link{background:linear-gradient(135deg,#f093fb,#f5576c);box-shadow:0 2px 8px rgba(245,87,108,.3)}.recommendation-card:nth-child(3) .recommendation-link{background:linear-gradient(135deg,#4facfe,#00f2fe);box-shadow:0 2px 8px rgba(79,172,254,.3)}.recommendation-card:nth-child(4) .recommendation-link{background:linear-gradient(135deg,#43e97b,#38f9d7);box-shadow:0 2px 8px rgba(67,233,123,.3)}.recommendation-card:nth-child(2):hover .recommendation-link{background:linear-gradient(135deg,#f5576c,#f093fb)}.recommendation-card:nth-child(3):hover .recommendation-link{background:linear-gradient(135deg,#00f2fe,#4facfe)}.recommendation-card:nth-child(4):hover .recommendation-link{background:linear-gradient(135deg,#38f9d7,#43e97b)}[data-theme=dark] .recommendations,body.dark .recommendations{background:linear-gradient(135deg,rgba(30,41,59,.95),rgba(15,23,42,.95));border-color:rgba(51,65,85,.8)}[data-theme=dark] .recommendation-card,body.dark .recommendation-card{background:rgba(30,41,59,.8);color:var(--text-color, #f1f5f9);border-color:rgba(51,65,85,.6)}[data-theme=dark] .recommendation-card:before,body.dark .recommendation-card:before{background:linear-gradient(90deg,#8b5cf6,#6366f1)}[data-theme=dark] .recommendation-content h3,body.dark .recommendation-content h3{color:var(--text-color, #f1f5f9)}[data-theme=dark] .recommendation-content p,body.dark .recommendation-content p{color:var(--text-muted, #cbd5e1)}@media (max-width: 768px){.recommendations{padding:1.5rem;margin-top:2rem}.recommendations h2{font-size:1.5rem;margin-bottom:1.5rem}#recommendationsContainer{grid-template-columns:1fr;gap:1.25rem}.recommendation-card{padding:1.5rem}.recommendation-icon{width:64px;height:64px;font-size:2rem}}@media (min-width: 769px) and (max-width: 1024px){#recommendationsContainer{grid-template-columns:repeat(2,1fr)}}\n/*$vite$:1*/',document.head.appendChild(e);let n=!1,r=null;async function a(){try{if("undefined"==typeof window||!window.Capacitor)return!1;if(window.Capacitor){n=!0,r=window.Capacitor;try{const e=await o(()=>t.import("./index-legacy-Be5GbcUB.js"),void 0);window.CapacitorApp=e.App}catch(e){}try{const e=await o(()=>t.import("./index-legacy-BZNPTBND.js"),void 0);window.CapacitorHaptics=e.Haptics}catch(e){}try{const e=await o(()=>t.import("./index-legacy-btPixbG7.js"),void 0);window.CapacitorKeyboard=e.Keyboard}catch(e){}try{const e=await o(()=>t.import("./index-legacy-Mchi7t09.js"),void 0);window.CapacitorStatusBar=e.StatusBar}catch(e){}try{const e=await o(()=>t.import("./index-legacy-CkK43Emy.js"),void 0);window.CapacitorPreferences=e.Preferences}catch(e){}try{const e=await o(()=>t.import("./index-legacy-BsXUyWNt.js"),void 0);window.CapacitorNetwork=e.Network}catch(e){}return window.CapacitorApp&&(window.CapacitorApp.addListener("appStateChange",({isActive:e})=>{e?window.dispatchEvent(new CustomEvent("app-foreground")):window.dispatchEvent(new CustomEvent("app-background"))}),window.CapacitorApp.addListener("appUrlOpen",e=>{window.dispatchEvent(new CustomEvent("app-url-open",{detail:e}))}),window.CapacitorApp.addListener("backButton",()=>{window.history.length>1?window.history.back():window.CapacitorApp.exitApp()})),async function(){if(window.CapacitorStatusBar)try{await window.CapacitorStatusBar.setStyle({style:"DARK"}),await window.CapacitorStatusBar.setBackgroundColor({color:"#007bff"}),await window.CapacitorStatusBar.setOverlaysWebView({overlay:!1})}catch(e){}}(),window.CapacitorKeyboard&&(window.CapacitorKeyboard.addListener("keyboardWillShow",e=>{window.dispatchEvent(new CustomEvent("keyboard-show",{detail:e}))}),window.CapacitorKeyboard.addListener("keyboardWillHide",()=>{window.dispatchEvent(new CustomEvent("keyboard-hide"))}),window.CapacitorKeyboard.setStyle({style:"DARK"}),window.CapacitorKeyboard.setResizeMode({mode:"NATIVE"})),!0}return!1}catch(a){return!1}}"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a());class i{constructor(){this.errorListeners=[],this.errorCount=0,this.maxErrors=10,this.errorWindow=6e4,this.errorTimestamps=[],this._lastError=null,this._rateLimitWarning=null}init(){if(window.addEventListener("error",e=>{this.handleError(e.error||e.message,{filename:e.filename,lineno:e.lineno,colno:e.colno,type:"javascript_error"})}),window.addEventListener("unhandledrejection",e=>{this.handleError(e.reason,{type:"unhandled_promise_rejection"})}),!console.error._errorBoundaryWrapped){const e=function(){}.bind(),t=this;console.error._originalError=e,console.error=function(...o){e.apply(console,o);const n=o.join(" "),r=Date.now();(!t._lastError||t._lastError.message!==n||r-t._lastError.timestamp>1e3)&&(t._lastError={message:n,timestamp:r})},console.error._errorBoundaryWrapped=!0}}handleError(e,t={}){if("console_error"===t.type)return;const o=Date.now();if(this.errorTimestamps=this.errorTimestamps.filter(e=>o-e<this.errorWindow),this.errorTimestamps.length>=this.maxErrors)return void((!this._rateLimitWarning||o-this._rateLimitWarning>6e4)&&(this._rateLimitWarning=o));this.errorTimestamps.push(o),this.errorCount++;const n={message:e instanceof Error?e.message:String(e),stack:e instanceof Error?e.stack:void 0,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,...t};this.logError(n),this.errorListeners.forEach(e=>{try{e(n)}catch(t){console.error._originalError}}),this.showUserError(n)}logError(e){if("undefined"!=typeof window&&window.ErrorHandler)try{window.ErrorHandler.logError(e)}catch(t){console.error._originalError}try{const t=JSON.parse(localStorage.getItem("app_errors")||"[]");t.unshift(e),t.splice(10),localStorage.setItem("app_errors",JSON.stringify(t))}catch(t){}}showUserError(e){if("console_error"!==e.type&&"undefined"!=typeof window&&window.showNotification){const t=this.getUserFriendlyMessage(e);window.showNotification(t,"error")}}getUserFriendlyMessage(e){const t=e.message.toLowerCase();return t.includes("network")||t.includes("fetch")?"Network error. Please check your connection and try again.":t.includes("firebase")||t.includes("auth")?"Authentication error. Please try logging in again.":t.includes("permission")||t.includes("denied")?"Permission denied. Please check your account settings.":t.includes("quota")||t.includes("limit")?"Storage limit reached. Please free up some space.":"An unexpected error occurred. Please try again or contact support if the problem persists."}addErrorListener(e){this.errorListeners.push(e)}removeErrorListener(e){this.errorListeners=this.errorListeners.filter(t=>t!==e)}wrapAsync(e,t="unknown"){return async(...o)=>{try{return await e(...o)}catch(n){throw this.handleError(n,{context:t,type:"async_error"}),n}}}async retry(e,t=3,o=1e3){let n;for(let a=0;a<t;a++)try{return await e()}catch(r){if(n=r,r.message&&(r.message.includes("permission")||r.message.includes("auth")||r.message.includes("invalid")))throw r;a<t-1&&await new Promise(e=>setTimeout(e,o*(a+1)))}throw n}}const s=new i;"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{s.init()}):s.init()),window.ErrorBoundary=i,window.errorBoundary=s;class d{constructor(){this.logs=[],this.maxLogs=100,this.levels={DEBUG:0,INFO:1,WARN:2,ERROR:3},this.currentLevel=this.levels.INFO,this.enableConsole="undefined"==typeof process||!1}debug(e,t={}){this.log("DEBUG",e,t)}info(e,t={}){this.log("INFO",e,t)}warn(e,t={}){this.log("WARN",e,t)}error(e,t={}){this.log("ERROR",e,t)}log(e,t,o={}){const n={level:e,message:t,data:o,timestamp:(new Date).toISOString(),url:"undefined"!=typeof window?window.location.href:"unknown",userAgent:"undefined"!=typeof navigator?navigator.userAgent:"unknown"};if(this.logs.push(n),this.logs.length>this.maxLogs&&this.logs.shift(),this.enableConsole&&(this.levels[e],this.currentLevel),"undefined"!=typeof window&&window.analytics)try{window.analytics.track("log",{level:e,message:t.substring(0,100)})}catch(r){}}getLogs(e=10,t=null){let o=[...this.logs].reverse();return t&&(o=o.filter(e=>e.level===t)),o.slice(0,e)}clearLogs(){this.logs=[]}setLevel(e){void 0!==this.levels[e]&&(this.currentLevel=this.levels[e])}}const c=new d;window.Logger=d,window.logger=c,"undefined"!=typeof process&&(console.log=(...e)=>c.info(e.join(" ")),console.debug=(...e)=>c.debug(e.join(" ")),console.info=(...e)=>c.info(e.join(" ")));class l{constructor(){this.patterns={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,phone:/^[\d\s\-\+\(\)]+$/,url:/^https?:\/\/.+/,numeric:/^\d+(\.\d+)?$/,alphanumeric:/^[a-zA-Z0-9\s]+$/,currency:/^\$?\d+(\.\d{2})?$/}}validateEmail(e){return!(!e||"string"!=typeof e)&&this.patterns.email.test(e.trim())}validateString(e,t={}){const{minLength:o=0,maxLength:n=1/0,required:r=!1,pattern:a=null,trim:i=!0}=t;if(r&&(!e||0===e.trim().length))return{valid:!1,sanitized:"",error:"This field is required"};if(!e)return{valid:!r,sanitized:"",error:r?"This field is required":null};const s=String(e);let d=i?s.trim():s;return d.length<o?{valid:!1,sanitized:d,error:`Must be at least ${o} characters`}:d.length>n?{valid:!1,sanitized:d,error:`Must be no more than ${n} characters`}:a&&!a.test(d)?{valid:!1,sanitized:d,error:"Invalid format"}:(d=this.sanitizeHTML(d),{valid:!0,sanitized:d,error:null})}validateNumber(e,t={}){const{min:o=-1/0,max:n=1/0,required:r=!1,integer:a=!1}=t;if(r&&(null==e||""===e))return{valid:!1,value:null,error:"This field is required"};if(null==e||""===e)return{valid:!r,value:null,error:r?"This field is required":null};const i=Number(e);return isNaN(i)?{valid:!1,value:null,error:"Must be a valid number"}:a&&!Number.isInteger(i)?{valid:!1,value:i,error:"Must be an integer"}:i<o?{valid:!1,value:i,error:`Must be at least ${o}`}:i>n?{valid:!1,value:i,error:`Must be no more than ${n}`}:{valid:!0,value:i,error:null}}validateCurrency(e,t={}){const{min:o=0,max:n=1/0,required:r=!1}=t,a=String(e).replace(/[$,\s]/g,""),i=this.validateNumber(a,{min:o,max:n,required:r});return i.valid?{valid:!0,value:Math.round(100*i.value)/100,error:null}:i}sanitizeHTML(e){if(!e||"string"!=typeof e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}sanitizeForDB(e){if(null==e)return null;if("string"==typeof e)return this.sanitizeHTML(e.trim());if("number"==typeof e)return isNaN(e)?null:e;if(Array.isArray(e))return e.map(e=>this.sanitizeForDB(e));if("object"==typeof e){const t={};for(const[o,n]of Object.entries(e))t[this.sanitizeHTML(String(o))]=this.sanitizeForDB(n);return t}return e}validateForm(e,t){const o={},n={};for(const[r,a]of Object.entries(t)){const t=e[r];let i;if("string"===a.type)i=this.validateString(t,a);else if("number"===a.type)i=this.validateNumber(t,a);else if("currency"===a.type)i=this.validateCurrency(t,a);else if("email"===a.type){const e=this.validateEmail(t);i={valid:e,sanitized:e?t.trim():"",error:e?null:"Invalid email address"}}else i={valid:!0,sanitized:t,error:null};i.valid||(o[r]=i.error),n[r]=void 0!==i.sanitized?i.sanitized:i.value}return{valid:0===Object.keys(o).length,errors:o,sanitized:n}}}const m=new l;window.InputValidator=l,window.inputValidator=m;class g{constructor(){this.requests=new Map,this.defaultLimit={window:6e4,max:60}}check(e,t={}){const o={window:t.window||this.defaultLimit.window,max:t.max||this.defaultLimit.max},n=Date.now();let r=this.requests.get(e);r&&n-r.windowStart>o.window&&(r=null),r||(r={count:0,windowStart:n},this.requests.set(e,r));const a=Math.max(0,o.max-r.count),i=r.count<o.max;return i&&r.count++,{allowed:i,remaining:a,resetTime:r.windowStart+o.window,limit:o.max}}reset(e){this.requests.delete(e)}clear(){this.requests.clear()}cleanup(){const e=Date.now();for(const[t,o]of this.requests.entries())e-o.windowStart>36e5&&this.requests.delete(t)}}const p=new g;"undefined"!=typeof window&&setInterval(()=>{p.cleanup()},3e5),window.RateLimiter=g,window.rateLimiter=p;class f{constructor(){this.csrfToken=this.generateCSRFToken(),this.rateLimits=new Map}generateCSRFToken(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}validateCSRFToken(e){return e===this.csrfToken}sanitizeForDisplay(e){if(!e||"string"!=typeof e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}isSafeURL(e){if(!e||"string"!=typeof e)return!1;try{const t=new URL(e,window.location.origin);return["http:","https:",""].includes(t.protocol)}catch{return!1}}validateFileUpload(e,t={}){const{maxSize:o=5242880,allowedTypes:n=["image/jpeg","image/png","image/gif","application/pdf"],allowedExtensions:r=[".jpg",".jpeg",".png",".gif",".pdf"]}=t;if(!e)return{valid:!1,error:"No file provided"};if(e.size>o)return{valid:!1,error:`File size exceeds maximum of ${o/1024/1024}MB`};if(!n.includes(e.type))return{valid:!1,error:"File type not allowed"};const a="."+e.name.split(".").pop().toLowerCase();return r.includes(a)?{valid:!0,error:null}:{valid:!1,error:"File extension not allowed"}}async hashData(e){const t=(new TextEncoder).encode(e),o=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(o)).map(e=>e.toString(16).padStart(2,"0")).join("")}checkRateLimit(e,t=10,o=6e4){const n=Date.now(),r=this.rateLimits.get(e);return!r||n-r.start>o?(this.rateLimits.set(e,{start:n,count:1}),!1):r.count>=t||(r.count++,!1)}clearRateLimit(e){this.rateLimits.delete(e)}cleanupRateLimits(){const e=Date.now();for(const[t,o]of this.rateLimits.entries())e-o.start>3e5&&this.rateLimits.delete(t)}}const u=new f;"undefined"!=typeof window&&setInterval(()=>{u.cleanupRateLimits()},3e5),window.SecurityService=f,window.securityService=u;class h{constructor(){this.insights=[],this.recommendations=[]}renderInsights(e,t){e&&0!==e.length?(this.insights=e,t.innerHTML=e.map(e=>`\n      <div class="insight-card">\n        <h3>${e.title}</h3>\n        <div class="insight-data">\n          ${Object.entries(e.data).map(([e,t])=>`\n            <div class="data-point">\n              <span class="data-label">${this.formatKey(e)}:</span>\n              <span class="data-value">${this.formatValue(t)}</span>\n            </div>\n          `).join("")}\n        </div>\n      </div>\n    `).join("")):t.innerHTML='\n        <div class="info-state">\n          <h3>ðŸ’¡ Get Started with Financial Insights</h3>\n          <p>Add some financial data using the tools above to get personalized insights and recommendations:</p>\n          <ul style="text-align: left; margin: 1rem 0;">\n            <li>ðŸ“‹ Use the <strong>Debt Tracker</strong> to add your debts</li>\n            <li>ðŸ’° Use the <strong>Budget Tracker</strong> to set up your budget</li>\n            <li>ðŸ’Ž Use the <strong>Net Worth Tracker</strong> to track your assets</li>\n            <li>ðŸŽ¯ Use the <strong>Savings Goal Tracker</strong> to set savings goals</li>\n          </ul>\n          <p>Once you add some data, we\'ll provide personalized insights and recommendations!</p>\n        </div>\n      '}renderRecommendations(e,t){e&&0!==e.length?(this.recommendations=e,t.innerHTML=e.map(e=>`\n      <div class="recommendation-card priority-${e.priority}">\n        <div class="recommendation-header">\n          <h3>${e.title}</h3>\n          <span class="priority-badge">Priority ${e.priority}</span>\n        </div>\n        <p class="recommendation-description">${e.description}</p>\n        <div class="recommendation-action">\n          <strong>Action:</strong> ${e.action}\n        </div>\n      </div>\n    `).join("")):t.innerHTML='\n        <div class="info-state">\n          <h3>ðŸŽ¯ Personalized Recommendations</h3>\n          <p>Once you start using the financial tools above, we\'ll analyze your data and provide personalized recommendations to help you:</p>\n          <ul style="text-align: left; margin: 1rem 0;">\n            <li>ðŸ’³ Optimize your credit utilization</li>\n            <li>ðŸ“Š Improve your debt payoff strategy</li>\n            <li>ðŸ’° Better manage your budget</li>\n            <li>ðŸŽ¯ Reach your savings goals faster</li>\n          </ul>\n          <p>Start by adding some financial data using the tools above!</p>\n        </div>\n      '}formatKey(e){return e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}formatValue(e){return"number"==typeof e?e>1e3?`$${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`:e<1||"number"==typeof e&&e<=100&&e>0?`${(100*e).toFixed(1)}%`:e<10?e.toFixed(2):e.toFixed(1):"object"==typeof e&&null!==e?e.name&&void 0!==e.interestRate?`${e.name} (${e.interestRate.toFixed(1)}%)`:JSON.stringify(e):e}}const b=new h;window.FinancialInsights=h,window.financialInsights=b;class w{constructor(){this.jsPDFLoaderPromise=null}async loadJsPDF(){return window.jspdf&&window.jspdf.jsPDF?window.jspdf.jsPDF:(this.jsPDFLoaderPromise||(this.jsPDFLoaderPromise=new Promise((e,t)=>{const o=document.querySelector('script[data-jspdf="true"]');if(o)return o.addEventListener("load",()=>{window.jspdf&&window.jspdf.jsPDF?e(window.jspdf.jsPDF):t(new Error("jsPDF loaded but constructor missing"))}),void o.addEventListener("error",()=>t(new Error("Failed to load jsPDF script")));const n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js",n.async=!0,n.dataset.jspdf="true",n.onload=()=>{window.jspdf&&window.jspdf.jsPDF?e(window.jspdf.jsPDF):t(new Error("jsPDF loaded but constructor missing"))},n.onerror=()=>t(new Error("Failed to load jsPDF script")),document.head.appendChild(n)})),this.jsPDFLoaderPromise)}async exportAllData(e,t,o,n){try{t("Preparing data export...","info");const r=await o(),a=n(r),i={displayName:localStorage.getItem("profileName")||window.auth?.currentUser?.displayName||"Bradley's Finance Hub Member",email:localStorage.getItem("profileEmail")||window.auth?.currentUser?.email||"Not linked",uid:window.auth?.currentUser?.uid||"",generatedAt:(new Date).toISOString()},s={exportInfo:{timestamp:(new Date).toISOString(),version:"2.1.0",format:e,userAgent:navigator.userAgent},account:i,userSettings:{darkMode:"true"===localStorage.getItem("darkMode"),theme:localStorage.getItem("theme"),notificationsEnabled:"false"!==localStorage.getItem("notificationsEnabled"),autoSaveEnabled:"false"!==localStorage.getItem("autoSaveEnabled"),showTipsEnabled:"false"!==localStorage.getItem("showTipsEnabled"),userAvatar:localStorage.getItem("userAvatar")?"Present":"Not set"},financialData:r,summary:a};"json"===e?this.exportAsJSON(s):"csv"===e?this.exportAsCSV(s):"pdf"===e&&await this.exportAsPDF(s),t(`Data exported successfully as ${e.toUpperCase()}!`,"success")}catch(r){t("Export failed. Please try again.","error")}}exportAsJSON(e){const t=JSON.stringify(e,null,2),o=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(o),r=document.createElement("a");r.href=n,r.download=`bradley-financial-data-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}exportAsCSV(e){let t="Data Type,Field,Value,Timestamp\n";t+=`Export Info,Format,${e.exportInfo.format},${e.exportInfo.timestamp}\n`,t+=`Export Info,Version,${e.exportInfo.version},${e.exportInfo.timestamp}\n`,Object.entries(e.userSettings).forEach(([o,n])=>{t+=`User Settings,${o},${n},${e.exportInfo.timestamp}\n`}),Object.entries(e.financialData).forEach(([o,n])=>{Array.isArray(n)?n.forEach(n=>{Object.entries(n).forEach(([n,r])=>{t+=`${o},${n},${r},${e.exportInfo.timestamp}\n`})}):"object"==typeof n&&Object.entries(n).forEach(([n,r])=>{t+=`${o},${n},${JSON.stringify(r)},${e.exportInfo.timestamp}\n`})});const o=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(o),r=document.createElement("a");r.href=n,r.download=`bradley-financial-data-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}async exportAsPDF(e){try{const e=await this.loadJsPDF();if(!e)throw new Error("Unable to load jsPDF library");const t=new e({unit:"pt",format:"letter"});t.setFontSize(22),t.text("Bradley's Finance Hub - Financial Report",50,50),t.setFontSize(12),t.text(`Generated: ${(new Date).toLocaleString()}`,50,80),t.save(`bradley-financial-report-${(new Date).toISOString().split("T")[0]}.pdf`)}catch(t){throw t}}}const y=new w;window.DataExport=w,window.dataExport=y;class x{constructor(){this.tips=[],this.currentTipIndex=0,this.rotationInterval=null}init(e){this.tips=e||[],this.currentTipIndex=0,this.updateTipDisplay(),this.startTipRotation()}updateTipDisplay(){if(0===this.tips.length)return;const e=this.tips[this.currentTipIndex];if(!e)return;const t=document.getElementById("tipCategory"),o=document.getElementById("tipNumber"),n=document.getElementById("tipTitle"),r=document.getElementById("tipContent");t&&(t.textContent=e.category),o&&(o.textContent=`${this.currentTipIndex+1} of ${this.tips.length}`),n&&(n.textContent=e.title),r&&(r.textContent=e.content),document.querySelectorAll(".nav-dot").forEach((e,t)=>{e.classList.toggle("active",t===this.currentTipIndex)})}nextTip(){this.currentTipIndex=(this.currentTipIndex+1)%this.tips.length,this.updateTipDisplay()}previousTip(){0===this.currentTipIndex?this.currentTipIndex=this.tips.length-1:this.currentTipIndex=this.currentTipIndex-1,this.updateTipDisplay()}goToTip(e){e>=0&&e<this.tips.length&&(this.currentTipIndex=e,this.updateTipDisplay())}startTipRotation(){this.stopTipRotation(),this.rotationInterval=setInterval(()=>{this.nextTip()},1e4)}stopTipRotation(){this.rotationInterval&&(clearInterval(this.rotationInterval),this.rotationInterval=null)}}const v=new x;window.FinancialTips=x,window.financialTips=v,window.nextTip=()=>v.nextTip(),window.previousTip=()=>v.previousTip(),window.goToTip=e=>v.goToTip(e);class k{constructor(){this.settings={darkMode:!1,notifications:!0,autoSave:!0,showTips:!0}}loadSettings(){const e=document.getElementById("settingsDarkMode"),t="true"===localStorage.getItem("darkMode")||"dark"===localStorage.getItem("theme");e&&(e.checked=t),t?document.body.classList.add("dark"):document.body.classList.remove("dark");const o=document.getElementById("settingsNotifications"),n=document.getElementById("settingsAutoSave"),r=document.getElementById("settingsShowTips");o&&(o.checked="false"!==localStorage.getItem("notificationsEnabled")),n&&(n.checked="false"!==localStorage.getItem("autoSaveEnabled")),r&&(r.checked="false"!==localStorage.getItem("showTipsEnabled"));const a=localStorage.getItem("userAvatar");if(a){const e=document.getElementById("profileAvatar");e&&(e.src=a)}this.settings={darkMode:t,notifications:o?.checked??!0,autoSave:n?.checked??!0,showTips:r?.checked??!0},"undefined"!=typeof window&&window.logger&&window.logger.debug("Settings loaded",{darkMode:t})}saveSetting(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(o){"undefined"!=typeof window&&window.logger&&window.logger.error("Failed to save setting",{key:e,error:o.message})}}loadSetting(e,t=null){try{const o=localStorage.getItem(e);return o?JSON.parse(o):t}catch(o){return"undefined"!=typeof window&&window.logger&&window.logger.error("Failed to load setting",{key:e,error:o.message}),t}}toggleDarkMode(){const e=document.getElementById("settingsDarkMode");if(!e)return void("undefined"!=typeof window&&window.logger&&window.logger.error("Dark mode toggle not found"));const t=e.checked;t?(document.body.classList.add("dark"),localStorage.setItem("theme","dark"),localStorage.setItem("darkMode","true")):(document.body.classList.remove("dark"),localStorage.setItem("theme","light"),localStorage.setItem("darkMode","false")),this.settings.darkMode=t,"function"==typeof window.showNotification&&window.showNotification("Dark mode "+(t?"enabled":"disabled"),"success")}toggleNotifications(){const e=document.getElementById("settingsNotifications").checked;localStorage.setItem("notificationsEnabled",e.toString()),this.settings.notifications=e,e&&"Notification"in window&&Notification.requestPermission(),"function"==typeof window.showNotification&&window.showNotification("Notifications "+(e?"enabled":"disabled"),"success")}toggleAutoSave(){const e=document.getElementById("settingsAutoSave").checked;localStorage.setItem("autoSaveEnabled",e.toString()),this.settings.autoSave=e,"function"==typeof window.showNotification&&window.showNotification("Auto-save "+(e?"enabled":"disabled"),"success")}toggleShowTips(){const e=document.getElementById("settingsShowTips").checked;localStorage.setItem("showTipsEnabled",e.toString()),this.settings.showTips=e;const t=document.querySelector(".financial-education");t&&(t.style.display=e?"block":"none"),"function"==typeof window.showNotification&&window.showNotification("Tips "+(e?"enabled":"disabled"),"success")}handleAvatarUpload(e){const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{const t=document.getElementById("profileAvatar");t&&(t.src=e.target.result),localStorage.setItem("userAvatar",e.target.result),"function"==typeof window.showNotification&&window.showNotification("Avatar updated successfully!","success")},e.readAsDataURL(t)}}}const S=new k;window.SettingsManager=k,window.settingsManager=S,window.toggleDarkModeSetting=()=>S.toggleDarkMode(),window.toggleNotifications=()=>S.toggleNotifications(),window.toggleAutoSave=()=>S.toggleAutoSave(),window.toggleShowTips=()=>S.toggleShowTips(),window.handleAvatarUpload=e=>S.handleAvatarUpload(e);class E{constructor(){this.stats={netWorth:null,totalDebt:null,creditUtilization:null,savingsProgress:null}}async updateProfileStats(e){const t=e?.currentUser;if(t){const e=document.getElementById("profileName"),o=document.getElementById("profileEmail");e&&(e.textContent=t.displayName||"User"),o&&(o.textContent=t.email||"Email")}let o=null,n=null,r=null,a=null;const i=(e=[])=>{if(!Array.isArray(e))return;const t=e.reduce((e,t)=>e+(parseFloat(t.balance)||0),0);Number.isNaN(t)||(n=t);const o=e.filter(e=>"credit"===e.type),a=o.reduce((e,t)=>e+(parseFloat(t.limit)||0),0),i=o.reduce((e,t)=>e+(parseFloat(t.balance)||0),0);a>0?r=i/a*100:null===r&&0===i&&(r=0)};try{const e=localStorage.getItem("debts");if(e&&i(JSON.parse(e)),null===n){const e=localStorage.getItem("local_test_debts");e&&i(JSON.parse(e))}const t=localStorage.getItem("netWorth");if(t){const e=JSON.parse(t);if(e&&e.history&&e.history.length>0){const t=e.history[e.history.length-1],n=parseFloat(t.netWorth);Number.isNaN(n)||(o=n)}}if(null===o){const e=localStorage.getItem("local_test_networth");if(e){const t=JSON.parse(e);if(t&&t.history&&t.history.length>0){const e=t.history[t.history.length-1],n=parseFloat(e.netWorth);Number.isNaN(n)||(o=n)}}}const d=localStorage.getItem("savingsGoals");if(d){const e=JSON.parse(d);if(Array.isArray(e)&&e.length>0){const t=e.reduce((e,t)=>e+(parseFloat(t.target)||0),0),o=e.reduce((e,t)=>e+(parseFloat(t.saved)||0),0);t>0?a=o/t*100:null===a&&(a=0)}}if(null===a){const e=localStorage.getItem("local_test_savings");if(e){const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){const e=t.reduce((e,t)=>e+(parseFloat(t.target)||0),0),o=t.reduce((e,t)=>e+(parseFloat(t.saved)||0),0);a=e>0?o/e*100:0}}}if("function"==typeof window.getLocalTestData)try{const e=window.getLocalTestData("userStats");e&&("number"==typeof e.netWorth&&(o=e.netWorth),"number"==typeof e.totalDebt&&(n=e.totalDebt),"number"==typeof e.creditUtilization&&(r=e.creditUtilization),"number"==typeof e.savingsProgress&&(a=e.savingsProgress))}catch(s){}const c=document.getElementById("profileNetWorth"),l=document.getElementById("profileTotalDebt"),m=document.getElementById("profileCreditUtilization"),g=document.getElementById("profileSavings");c&&(c.textContent=Number.isFinite(o)?`$${Math.round(o).toLocaleString()}`:"-"),l&&(l.textContent=Number.isFinite(n)?`$${Math.round(n).toLocaleString()}`:"-"),m&&(m.textContent=Number.isFinite(r)?`${r.toFixed(1)}%`:"-"),g&&(g.textContent=Number.isFinite(a)?`${a.toFixed(1)}%`:"-"),this.stats={netWorth:o,totalDebt:n,creditUtilization:r,savingsProgress:a}}catch(d){const e={profileNetWorth:"-",profileTotalDebt:"-",profileCreditUtilization:"-",profileSavings:"-"};Object.entries(e).forEach(([e,t])=>{const o=document.getElementById(e);o&&(o.textContent=t)})}}getStats(){return{...this.stats}}}const D=new E;window.ProfileStats=E,window.profileStats=D,window.updateProfileStats=e=>D.updateProfileStats(e);class I{constructor(){this.modal=null,this.isOpen=!1}openAdvancedSettings(){let e=document.getElementById("advancedSettingsModal");if(!e){if(e=document.createElement("div"),e.id="advancedSettingsModal",e.className="modal",e.style.display="none",e.innerHTML='\n        <div class="modal-content" style="max-width: 600px;">\n          <div class="modal-header">\n            <h2>âš™ï¸ Advanced Settings</h2>\n            <button class="close-btn" id="closeAdvancedSettings">&times;</button>\n          </div>\n          <div class="modal-body">\n            <div class="settings-section">\n              <h3>Data Management</h3>\n              <div class="setting-item">\n                <label>\n                  <input type="checkbox" id="enableAutoBackup" checked>\n                  Enable automatic data backup\n                </label>\n                <p class="setting-description">Automatically backup your data to cloud storage</p>\n              </div>\n              <div class="setting-item">\n                <label>\n                  <input type="checkbox" id="enableDataSync" checked>\n                  Enable data synchronization\n                </label>\n                <p class="setting-description">Sync your data across all devices</p>\n              </div>\n            </div>\n            \n            <div class="settings-section">\n              <h3>Performance</h3>\n              <div class="setting-item">\n                <label>\n                  <input type="checkbox" id="enableCaching" checked>\n                  Enable browser caching\n                </label>\n                <p class="setting-description">Cache data locally for faster loading</p>\n              </div>\n              <div class="setting-item">\n                <label>\n                  <input type="checkbox" id="enableLazyLoading" checked>\n                  Enable lazy loading\n                </label>\n                <p class="setting-description">Load content as needed for better performance</p>\n              </div>\n            </div>\n            \n            <div class="settings-section">\n              <h3>Privacy & Security</h3>\n              <div class="setting-item">\n                <label>\n                  <input type="checkbox" id="enableAnalytics" checked>\n                  Enable analytics\n                </label>\n                <p class="setting-description">Help us improve by sharing anonymous usage data</p>\n              </div>\n              <div class="setting-item">\n                <label>\n                  <input type="checkbox" id="enableErrorReporting" checked>\n                  Enable error reporting\n                </label>\n                <p class="setting-description">Automatically report errors to help fix issues</p>\n              </div>\n            </div>\n            \n            <div class="settings-section">\n              <h3>Experimental Features</h3>\n              <div class="setting-item">\n                <label>\n                  <input type="checkbox" id="enableBetaFeatures">\n                  Enable beta features\n                </label>\n                <p class="setting-description">Try out new features before they\'re released</p>\n              </div>\n            </div>\n            \n            <div class="settings-actions">\n              <button class="btn btn-primary" id="saveAdvancedSettings">Save Settings</button>\n              <button class="btn btn-secondary" id="resetAdvancedSettings">Reset to Defaults</button>\n            </div>\n          </div>\n        </div>\n      ',document.body.appendChild(e),!document.getElementById("advancedSettingsStyles")){const e=document.createElement("style");e.id="advancedSettingsStyles",e.textContent='\n          #advancedSettingsModal {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.5);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 10000;\n          }\n          #advancedSettingsModal .modal-content {\n            background: white;\n            border-radius: 12px;\n            padding: 24px;\n            max-width: 600px;\n            max-height: 80vh;\n            overflow-y: auto;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n          }\n          #advancedSettingsModal .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 20px;\n            padding-bottom: 12px;\n            border-bottom: 1px solid #e5e7eb;\n          }\n          #advancedSettingsModal .modal-header h2 {\n            margin: 0;\n            font-size: 1.5rem;\n          }\n          #advancedSettingsModal .close-btn {\n            background: none;\n            border: none;\n            font-size: 2rem;\n            cursor: pointer;\n            color: #6b7280;\n            padding: 0;\n            width: 32px;\n            height: 32px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n          }\n          #advancedSettingsModal .close-btn:hover {\n            color: #1f2937;\n          }\n          #advancedSettingsModal .settings-section {\n            margin-bottom: 24px;\n          }\n          #advancedSettingsModal .settings-section h3 {\n            margin-bottom: 12px;\n            font-size: 1.1rem;\n            color: #374151;\n          }\n          #advancedSettingsModal .setting-item {\n            margin-bottom: 16px;\n          }\n          #advancedSettingsModal .setting-item label {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            font-weight: 500;\n          }\n          #advancedSettingsModal .setting-item input[type="checkbox"] {\n            margin-right: 8px;\n            width: 18px;\n            height: 18px;\n            cursor: pointer;\n          }\n          #advancedSettingsModal .setting-description {\n            margin: 4px 0 0 26px;\n            font-size: 0.875rem;\n            color: #6b7280;\n          }\n          #advancedSettingsModal .settings-actions {\n            display: flex;\n            gap: 12px;\n            margin-top: 24px;\n            padding-top: 20px;\n            border-top: 1px solid #e5e7eb;\n          }\n          #advancedSettingsModal .btn {\n            padding: 10px 20px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            transition: all 0.2s;\n          }\n          #advancedSettingsModal .btn-primary {\n            background: #2563eb;\n            color: white;\n          }\n          #advancedSettingsModal .btn-primary:hover {\n            background: #1d4ed8;\n          }\n          #advancedSettingsModal .btn-secondary {\n            background: #e5e7eb;\n            color: #374151;\n          }\n          #advancedSettingsModal .btn-secondary:hover {\n            background: #d1d5db;\n          }\n        ',document.head.appendChild(e)}const t=e.querySelector("#closeAdvancedSettings"),o=e.querySelector("#saveAdvancedSettings"),n=e.querySelector("#resetAdvancedSettings");t.addEventListener("click",()=>this.closeAdvancedSettings()),o.addEventListener("click",()=>this.saveAdvancedSettings()),n.addEventListener("click",()=>this.resetAdvancedSettings()),e.addEventListener("click",t=>{t.target===e&&this.closeAdvancedSettings()}),this.loadAdvancedSettings()}this.modal=e,e.style.display="flex",this.isOpen=!0,document.body.style.overflow="hidden"}closeAdvancedSettings(){this.modal&&(this.modal.style.display="none",this.isOpen=!1,document.body.style.overflow="")}loadAdvancedSettings(){if(!this.modal)return;const e={enableAutoBackup:"false"!==localStorage.getItem("advanced_autoBackup"),enableDataSync:"false"!==localStorage.getItem("advanced_dataSync"),enableCaching:"false"!==localStorage.getItem("advanced_caching"),enableLazyLoading:"false"!==localStorage.getItem("advanced_lazyLoading"),enableAnalytics:"false"!==localStorage.getItem("advanced_analytics"),enableErrorReporting:"false"!==localStorage.getItem("advanced_errorReporting"),enableBetaFeatures:"true"===localStorage.getItem("advanced_betaFeatures")};Object.entries(e).forEach(([e,t])=>{const o=this.modal.querySelector(`#${e}`);o&&(o.checked=t)})}saveAdvancedSettings(){if(!this.modal)return;const e={autoBackup:this.modal.querySelector("#enableAutoBackup").checked,dataSync:this.modal.querySelector("#enableDataSync").checked,caching:this.modal.querySelector("#enableCaching").checked,lazyLoading:this.modal.querySelector("#enableLazyLoading").checked,analytics:this.modal.querySelector("#enableAnalytics").checked,errorReporting:this.modal.querySelector("#enableErrorReporting").checked,betaFeatures:this.modal.querySelector("#enableBetaFeatures").checked};Object.entries(e).forEach(([e,t])=>{localStorage.setItem(`advanced_${e}`,t.toString())}),"function"==typeof window.showNotification&&window.showNotification("Advanced settings saved successfully!","success"),this.closeAdvancedSettings()}resetAdvancedSettings(){this.modal&&confirm("Are you sure you want to reset all advanced settings to defaults?")&&(["autoBackup","dataSync","caching","lazyLoading","analytics","errorReporting","betaFeatures"].forEach(e=>{localStorage.removeItem(`advanced_${e}`)}),this.loadAdvancedSettings(),"function"==typeof window.showNotification&&window.showNotification("Advanced settings reset to defaults","info"))}}const L=new I;window.AdvancedSettings=I,window.advancedSettings=L,window.openAdvancedSettings=()=>L.openAdvancedSettings();class T{constructor(){this.notifications=[],this.container=null,this.maxNotifications=5,this.defaultDuration=3e3}init(){if(!this.container&&(this.container=document.createElement("div"),this.container.id="notificationContainer",this.container.className="notification-container",document.body.appendChild(this.container),!document.getElementById("notificationSystemStyles"))){const e=document.createElement("style");e.id="notificationSystemStyles",e.textContent="\n          .notification-container {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            z-index: 10000;\n            display: flex;\n            flex-direction: column;\n            gap: 12px;\n            max-width: 400px;\n            pointer-events: none;\n          }\n          .notification {\n            background: white;\n            border-radius: 8px;\n            padding: 16px 20px;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            pointer-events: auto;\n            animation: slideIn 0.3s ease-out;\n            border-left: 4px solid #2563eb;\n          }\n          .notification.success {\n            border-left-color: #22c55e;\n          }\n          .notification.error {\n            border-left-color: #ef4444;\n          }\n          .notification.warning {\n            border-left-color: #f59e0b;\n          }\n          .notification.info {\n            border-left-color: #3b82f6;\n          }\n          .notification-icon {\n            font-size: 1.5rem;\n            flex-shrink: 0;\n          }\n          .notification-content {\n            flex: 1;\n          }\n          .notification-message {\n            margin: 0;\n            font-size: 0.875rem;\n            color: #1f2937;\n            font-weight: 500;\n          }\n          .notification-close {\n            background: none;\n            border: none;\n            font-size: 1.25rem;\n            cursor: pointer;\n            color: #6b7280;\n            padding: 0;\n            width: 24px;\n            height: 24px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            flex-shrink: 0;\n          }\n          .notification-close:hover {\n            color: #1f2937;\n          }\n          @keyframes slideIn {\n            from {\n              transform: translateX(100%);\n              opacity: 0;\n            }\n            to {\n              transform: translateX(0);\n              opacity: 1;\n            }\n          }\n          @keyframes slideOut {\n            from {\n              transform: translateX(0);\n              opacity: 1;\n            }\n            to {\n              transform: translateX(100%);\n              opacity: 0;\n            }\n          }\n          .notification.removing {\n            animation: slideOut 0.3s ease-in forwards;\n          }\n        ",document.head.appendChild(e)}}show(e,t="info",o=this.defaultDuration){if(this.container||this.init(),this.notifications.length>=this.maxNotifications){const e=this.notifications.shift();this.remove(e.id)}const n=document.createElement("div"),r=`notification-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;n.id=r,n.className=`notification ${t}`;const a={success:"âœ…",error:"âŒ",warning:"âš ï¸",info:"â„¹ï¸"};return n.innerHTML=`\n      <span class="notification-icon">${a[t]||a.info}</span>\n      <div class="notification-content">\n        <p class="notification-message">${this.escapeHtml(e)}</p>\n      </div>\n      <button class="notification-close" onclick="window.notificationSystem.remove('${r}')">&times;</button>\n    `,this.container.appendChild(n),this.notifications.push({id:r,element:n,duration:o}),o>0&&setTimeout(()=>{this.remove(r)},o),r}remove(e){const t=this.notifications.find(t=>t.id===e);t&&(t.element.classList.add("removing"),setTimeout(()=>{t.element.parentNode&&t.element.parentNode.removeChild(t.element),this.notifications=this.notifications.filter(t=>t.id!==e)},300))}clear(){this.notifications.forEach(e=>{this.remove(e.id)})}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}success(e,t=this.defaultDuration){return this.show(e,"success",t)}error(e,t=this.defaultDuration){return this.show(e,"error",t)}warning(e,t=this.defaultDuration){return this.show(e,"warning",t)}info(e,t=this.defaultDuration){return this.show(e,"info",t)}}const z=new T;window.NotificationSystem=T,window.notificationSystem=z,window.showNotification=(e,t,o)=>z.show(e,t,o),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>z.init()):z.init();class A{constructor(e,t){this.auth=e,this.db=t,this.stats={creditUtilization:null,netWorth:null,totalDebt:null,savingsProgress:null}}isTestUser(e){return!(!e||!e.email)&&(window.CONFIG?.security?.allowUnverifiedAccounts||[]).map(e=>e.toLowerCase()).includes(e.email.toLowerCase())}async loadDashboardData(e){if(!this.auth||!this.db)return;const n=this.auth.currentUser;if(n)if(e)try{let e,i,s,d;try{const n=await o(()=>t.import("https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"),void 0);e=n.doc,i=n.getDoc,s=n.setDoc,d=n.onSnapshot}catch(r){throw new Error("Firestore functions not available")}const c=e(this.db,"users",n.uid);try{const e=await i(c),t=this.isTestUser(n);if(e.exists()){const o=e.data(),r=!(o.creditUtilization&&0!==o.creditUtilization||o.netWorth&&0!==o.netWorth||o.totalDebt&&0!==o.totalDebt||o.sampleDataInitialized);if(r&&t){await this.initializeSampleData(n);const e=await i(c);if(e.exists()){const t=e.data();this.updateStatsFromData(t)}}else r&&!t||this.updateStatsFromData(o)}else t?await this.initializeSampleData(n):await s(c,{email:n.email,displayName:n.displayName||"",joined:(new Date).toISOString(),lastLogin:(new Date).toISOString(),creditUtilization:0,netWorth:0,totalDebt:0,savingsProgress:0},{merge:!0})}catch(a){this.isTestUser(n)?this.applyLocalDashboardData():this.setDefaultValues()}try{const e=d(c,e=>{try{if(!e.exists())return void(this.isTestUser(n)?this.initializeSampleData(n):this.setDefaultValues());const t=e.data()||{};if(!(t.creditUtilization&&0!==t.creditUtilization||t.netWorth&&0!==t.netWorth||t.totalDebt&&0!==t.totalDebt||t.sampleDataInitialized)&&this.isTestUser(n))return void this.initializeSampleData(n).then(()=>{let e={creditUtilization:37.5,netWorth:54200,totalDebt:23300,savingsProgress:44};if("function"==typeof window.getLocalTestData){const t=window.getLocalTestData("userStats");t&&(e=t)}else window.LOCAL_TEST_DATA?.userStats&&Object.assign(e,window.LOCAL_TEST_DATA.userStats);this.updateStatsFromData(e)});this.updateStatsFromData(t)}catch(a){}},e=>{this.isTestUser(n)?this.applyLocalDashboardData():this.setDefaultValues()});"undefined"!=typeof window&&(window._dashboardUnsubscribe=e)}catch(a){this.isTestUser(n)?this.applyLocalDashboardData():this.setDefaultValues()}}catch(a){window.ErrorHandler&&window.ErrorHandler.handleFirebaseError(a),this.isTestUser(n)?this.applyLocalDashboardData():this.setDefaultValues()}else this.isTestUser(n)?this.applyLocalDashboardData():this.setDefaultValues();else"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname||this.applyLocalDashboardData()}updateStatsFromData(e){const t=e.creditUtilization,o=document.getElementById("creditUtilizationValue");o&&(void 0===t||isNaN(t)?(o.textContent="No data yet",o.style.color="#64748b"):(o.textContent=`${Number(t).toFixed(1)}%`,o.style.color=t<30?"#22c55e":t<50?"#f59e42":"#ef4444",this.stats.creditUtilization=t));const n=e.netWorth,r=document.getElementById("netWorthValue");if(r)if(void 0===n||isNaN(n))r.textContent="No data yet",r.style.color="#64748b";else{const e=Number(n).toLocaleString("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0});r.textContent=e,r.style.color=n>=0?"#22c55e":"#ef4444",this.stats.netWorth=n}const a=e.totalDebt,i=document.getElementById("debtSummaryValue");if(i)if(void 0===a||isNaN(a))i.textContent="No data yet",i.style.color="#64748b";else{const e=Number(a).toLocaleString("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0});i.textContent=e,i.style.color=a>0?"#ef4444":"#22c55e",this.stats.totalDebt=a}const s=e.savingsProgress,d=document.getElementById("savingsValue");d&&(void 0===s||isNaN(s)?(d.textContent="No data yet",d.style.color="#64748b"):(d.textContent=`${Number(s).toFixed(1)}% of goals`,d.style.color=s>=100?"#22c55e":s>=50?"#f59e42":"#ef4444",this.stats.savingsProgress=s))}setDefaultValues(){["creditUtilizationValue","netWorthValue","debtSummaryValue","savingsValue"].forEach(e=>{const t=document.getElementById(e);t&&(t.textContent="No data yet",t.style.color="#64748b")})}applyLocalDashboardData(){let e=null;if("function"==typeof window.getLocalTestData?e=window.getLocalTestData("userStats"):window.LOCAL_TEST_DATA?.userStats&&(e=window.LOCAL_TEST_DATA.userStats),e)this.updateStatsFromData(e);else{const e={creditUtilization:37.5,netWorth:54200,totalDebt:23300,savingsProgress:44};this.updateStatsFromData(e)}}async initializeSampleData(e){if(e&&this.db&&this.isTestUser(e))try{const{doc:n,getDoc:r,setDoc:a,onSnapshot:i}=await o(async()=>{const{doc:e,getDoc:o,setDoc:n,onSnapshot:r}=await t.import("https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js");return{doc:e,getDoc:o,setDoc:n,onSnapshot:r}},void 0),s=n(this.db,"users",e.uid),d=await r(s);if(!d.exists()||0===d.data().creditUtilization&&0===d.data().netWorth&&0===d.data().totalDebt){let t={creditUtilization:37.5,netWorth:54200,totalDebt:23300,savingsProgress:44};if("function"==typeof window.getLocalTestData){const e=window.getLocalTestData("userStats");e&&(t=e)}else window.LOCAL_TEST_DATA?.userStats&&(t=window.LOCAL_TEST_DATA.userStats);await a(s,{email:e.email,displayName:e.displayName||"",joined:(new Date).toISOString(),lastLogin:(new Date).toISOString(),creditUtilization:t.creditUtilization||0,netWorth:t.netWorth||0,totalDebt:t.totalDebt||0,savingsProgress:t.savingsProgress||0,sampleDataInitialized:!0},{merge:!0}),this.updateStatsFromData(t),setTimeout(()=>{this.updateStatsFromData(t)},100)}}catch(n){}}getStats(){return{...this.stats}}}async function N(){const e={};try{const t=localStorage.getItem("debts");t&&(e.debts=JSON.parse(t));const o=localStorage.getItem("budgets");o&&(e.budgets=JSON.parse(o));const n=localStorage.getItem("savingsGoals");n&&(e.savingsGoals=JSON.parse(n));const r=localStorage.getItem("netWorth");r&&(e.netWorth=JSON.parse(r));const a=localStorage.getItem("velocityCalculations");a&&(e.velocityCalculations=JSON.parse(a));const i=localStorage.getItem("taxCalculations");i&&(e.taxCalculations=JSON.parse(i));const s=localStorage.getItem("activityLogs");s&&(e.activityLogs=JSON.parse(s))}catch(t){}return e}function C(e){if(!e||"object"!=typeof e)throw new Error("Invalid financial data: data must be an object");const t=Array.isArray(e.debts)?e.debts:[],o=Array.isArray(e.savings)?e.savings:[],n=Array.isArray(e.assets)?e.assets:[],r=Array.isArray(e.income)?e.income:[],a=t.reduce((e,t)=>{const o="number"!=typeof t.balance||isNaN(t.balance)?0:t.balance;return e+Math.max(0,o)},0),i=o.reduce((e,t)=>{const o="number"!=typeof t.balance||isNaN(t.balance)?0:t.balance;return e+Math.max(0,o)},0),s=n.reduce((e,t)=>{const o="number"!=typeof t.value||isNaN(t.value)?0:t.value;return e+Math.max(0,o)},0),d=r.reduce((e,t)=>{const o="number"!=typeof t.amount||isNaN(t.amount)?0:t.amount;return e+Math.max(0,o)},0),c=t.filter(e=>"credit_card"===e.type||e.creditLimit),l=c.reduce((e,t)=>{const o="number"!=typeof t.balance||isNaN(t.balance)?0:t.balance;return e+Math.max(0,o)},0),m=c.reduce((e,t)=>{const o="number"!=typeof t.creditLimit||isNaN(t.creditLimit)?0:t.creditLimit;return e+Math.max(0,o)},0),g=m>0?l/m*100:0,p=s+i-a,f=d>0?a/d*100:a>0?1/0:0,u=[];return g>30&&u.push("Your credit utilization is above the recommended 30%. Consider paying down credit card balances."),f>36&&u.push("Your debt-to-income ratio is high. Focus on reducing debt or increasing income."),p<0&&u.push("Your net worth is negative. Create a plan to reduce debt and build savings."),0===i&&a>0&&u.push("Consider building an emergency fund while paying down debt."),{metrics:{totalDebt:Math.round(100*a)/100,totalSavings:Math.round(100*i)/100,totalAssets:Math.round(100*s)/100,totalIncome:Math.round(100*d)/100,netWorth:Math.round(100*p)/100,creditUtilization:Math.round(100*g)/100,debtToIncomeRatio:Math.round(100*f)/100},recommendations:u}}let j,F,M,U,B,O;(async()=>{try{let e=0;for(;(!window.auth||!window.db)&&e<50;)await new Promise(e=>setTimeout(e,100)),e++;window.auth&&window.db&&(j=window.auth,F=window.db,M=window.logout,U=window.extendSession,B=window.login,O=window.register)}catch(e){}})();let P=null;function $(){["creditUtilizationValue","netWorthValue","debtSummaryValue","savingsValue"].forEach(e=>{const t=document.getElementById(e);t&&(t.textContent="No data yet",t.style.color="#64748b")})}async function _(){const e=j||window.auth,t=F||window.db;if(!e||!t)return await new Promise(e=>setTimeout(e,500)),_();if(!e.currentUser){let t=!1;return e.onAuthStateChanged(e=>{e&&!t?(t=!0,setTimeout(()=>{R()},500)):e||($(),t=!1)}),void $()}await R()}async function R(){if(!A)return;const e=j||window.auth,t=F||window.db;if(e&&t)try{P=new A(e,t);const o="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,n="undefined"!=typeof USE_FIRESTORE?USE_FIRESTORE:!o;if(s&&"function"==typeof s.wrapAsync){const e=s.wrapAsync(()=>P.loadDashboardData(n),"dashboard_data_load");await e()}else await P.loadDashboardData(n);c&&"function"==typeof c.info&&c.info("Dashboard data initialized successfully")}catch(o){c&&"function"==typeof c.error&&c.error("Failed to initialize dashboard data",{error:o.message}),s&&"function"==typeof s.handleError&&s.handleError(o,{context:"dashboard_initialization"})}}async function W(){try{if("function"==typeof waitForAuth){const{auth:e,db:t}=await waitForAuth(1e4);window.auth=e,window.db=t,j||(j=e),F||(F=t)}else{let e=0;const t=50;for(;!j&&!window.auth||!F&&!window.db;){if(e>=t)return void $();await new Promise(e=>setTimeout(e,100)),e++}}window.auth||(window.auth=j),window.db||(window.db=F),await new Promise(e=>setTimeout(e,300));const e=j||window.auth,t=!!e?.currentUser;_().catch(e=>{}),t||setTimeout(()=>{const e=j||window.auth;e?.currentUser&&R()},1e3)}catch(e){$()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",W):W();const q=document.getElementById("profileButton"),V=document.getElementById("profileModal"),H=document.getElementById("closeProfileModal");function J(){if(!V)return c&&c.error("Profile modal not found"),void(s&&s.handleError(new Error("Profile modal not found"),{context:"profile_modal"}));V.style.display="flex",c&&c.debug("Modal display set to flex"),D&&D.updateProfileStats(j),Y(),setTimeout(()=>{c&&c.debug("Avatar elements check",{container:!!document.querySelector(".avatar-container"),uploadButton:!!document.querySelector(".avatar-upload-btn"),modalVisible:V.style.display,computedStyle:window.getComputedStyle(V).display})},100)}function Y(){if(void 0===window.themeManager)return void(c&&c.warn("ThemeManager not available"));const e=document.getElementById("themeDropdownButton"),t=document.getElementById("themeDropdownMenu");if(!e||!t)return void(c&&c.warn("Theme selector elements not found"));const o=window.themeManager.getAvailableThemes?window.themeManager.getAvailableThemes():["blue","pink","green","purple","orange","teal","red","auto"],n={blue:{name:"Blue",color:"#007bff",icon:"ðŸ”µ"},pink:{name:"Pink",color:"#ff4b91",icon:"ðŸ©·"},green:{name:"Green",color:"#28a745",icon:"ðŸŸ¢"},purple:{name:"Purple",color:"#6f42c1",icon:"ðŸŸ£"},orange:{name:"Orange",color:"#fd7e14",icon:"ðŸŸ "},teal:{name:"Teal",color:"#20c997",icon:"ðŸ”·"},red:{name:"Red",color:"#dc3545",icon:"ðŸ”´"},auto:{name:"Auto",color:"#64748b",icon:"âš™ï¸"}};t.innerHTML=o.map(e=>{const t=n[e]||{name:e,color:"#007bff"};return`\n      <div class="theme-option" data-theme="${e}">\n        <div class="theme-swatch" style="background: ${t.color}"></div>\n        <span>${t.name}</span>\n      </div>\n    `}).join(""),t.querySelectorAll(".theme-option").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.theme;window.themeManager.setTheme(t),K()})}),K()}function K(){if(void 0===window.themeManager)return;const e=window.themeManager.getCurrentTheme?window.themeManager.getCurrentTheme():"blue",t=document.getElementById("themeDropdownMenu");t&&t.querySelectorAll(".theme-option").forEach(t=>{t.dataset.theme===e?t.classList.add("active"):t.classList.remove("active")})}if(c&&(c.debug("Profile button found",{exists:!!q}),c.debug("Profile modal found",{exists:!!V})),q?q.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),c&&c.debug("Profile button clicked, opening modal"),J()}):(c&&c.error("Profile button not found"),s&&s.handleError(new Error("Profile button not found"),{context:"profile_button"})),window.addEventListener("profile-modal-open",()=>{c&&c.debug("Profile modal open event received"),J()}),H&&H.addEventListener("click",()=>{V&&(V.style.display="none")}),window.addEventListener("click",e=>{e.target===V&&V&&(V.style.display="none")}),S){S.loadSettings();const e=document.getElementById("settingsDarkMode");e&&e.addEventListener("change",()=>S.toggleDarkMode());const t=document.getElementById("settingsNotifications");t&&t.addEventListener("change",()=>S.toggleNotifications());const o=document.getElementById("settingsAutoSave");o&&o.addEventListener("change",()=>S.toggleAutoSave());const n=document.getElementById("settingsShowTips");n&&n.addEventListener("change",()=>S.toggleShowTips());const r=document.getElementById("avatarUpload");r&&r.addEventListener("change",e=>S.handleAvatarUpload(e))}const G=document.getElementById("advancedSettingsBtn");if(G&&L&&G.addEventListener("click",()=>{L.openAdvancedSettings()}),v){const e=[{category:"Debt Management",title:"Pay High-Interest Debt First",content:"Focus on paying off debts with the highest interest rates first to save money over time."},{category:"Savings",title:"Build an Emergency Fund",content:"Aim to save 3-6 months of expenses in an emergency fund for unexpected situations."},{category:"Budgeting",title:"Track Every Expense",content:"Keep track of all your expenses to understand where your money is going."},{category:"Credit",title:"Keep Credit Utilization Low",content:"Try to keep your credit card balances below 30% of your credit limits."}];v.init(e);const t=document.getElementById("nextTip"),o=document.getElementById("previousTip");t&&t.addEventListener("click",()=>v.nextTip()),o&&o.addEventListener("click",()=>v.previousTip())}async function X(e){if(!y)return c&&c.error("DataExport component not available"),void(s&&s.handleError(new Error("DataExport component not available"),{context:"data_export"}));if(!["json","csv","pdf"].includes(e))return c&&c.error("Invalid export format",{format:e}),void(s&&s.handleError(new Error(`Invalid export format: ${e}`),{context:"data_export"}));const t=z?(e,t)=>z.show(e,t):(e,t)=>{};await y.exportAllData(e,t,N,C)}const Z=document.getElementById("exportJSON"),Q=document.getElementById("exportCSV"),ee=document.getElementById("exportPDF");async function te(){if(b)try{if(p&&!p.check("financial_insights_update",{window:6e4,max:10}).allowed)return void(c&&c.warn("Rate limit exceeded for financial insights update"));const e=C(await N()),t=[];e.metrics.totalDebt>0&&t.push({title:"Debt Overview",data:{totalDebt:e.metrics.totalDebt,creditUtilization:e.metrics.creditUtilization}}),null!==e.metrics.netWorth&&t.push({title:"Net Worth",data:{current:e.metrics.netWorth,change:e.metrics.netWorthChange}});const o=document.getElementById("financialInsights");o&&b.renderInsights(t,o);const n=[];e.metrics.creditUtilization>30&&n.push({title:"Reduce Credit Utilization",description:"Your credit utilization is above the recommended 30%.",action:"Pay down credit card balances to improve your credit score.",priority:1}),e.metrics.totalDebt>0&&e.metrics.netWorth<0&&n.push({title:"Focus on Debt Reduction",description:"Your net worth is negative due to debt.",action:"Create a debt payoff plan and stick to it.",priority:1});const r=document.getElementById("recommendationsContainer");r&&b.renderRecommendations(n,r)}catch(e){c&&c.error("Error updating financial insights",{error:e.message,stack:e.stack}),s&&s.handleError(e,{context:"financial_insights_update"})}else c&&c.warn("FinancialInsights component not available")}if(Z&&Z.addEventListener("click",()=>X("json")),Q&&Q.addEventListener("click",()=>X("csv")),ee&&ee.addEventListener("click",()=>X("pdf")),j){const e=()=>{j.currentUser&&setTimeout(te,1e3)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):setTimeout(e,2e3)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{te()}):te(),window.openProfileModal=()=>{J()},window.updateProfileStats=()=>{D&&D.updateProfileStats(j)},window.initializeThemeSelector=Y,window.updateThemeSelector=K,window.handleExport=X,window.updateFinancialInsights=te}}});
