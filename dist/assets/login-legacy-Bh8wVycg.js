System.register(["./modulepreload-polyfill-legacy-CnvmjJHj.js","./theme-legacy-Bd_heFTc.js","./config-legacy-CFYw0t9_.js","./validation-legacy-CKvymyiF.js","./vendor-utils-legacy-BZiHMGip.js","./auth-legacy-CXkRVKZL.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"],function(e,t){"use strict";var n,o,r,i,l,a,s,d;return{setters:[null,null,null,null,null,e=>{n=e.e,o=e.a,r=e.l},e=>{i=e.setPersistence,l=e.browserLocalPersistence,a=e.browserSessionPersistence,s=e.GoogleAuthProvider,d=e.signInWithPopup},null,null],execute:function(){var e=document.createElement("style");e.textContent="body{font-family:Poppins,sans-serif;background:#f8fafc;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;color:#1e293b}.login-container{background:#fff;padding:2.5rem;border-radius:1rem;box-shadow:0 4px 6px -1px rgba(0,0,0,.1);width:100%;max-width:400px;text-align:center}.logo-container{margin-bottom:2rem}.logo{width:120px;height:auto;margin-bottom:1rem}h1{font-size:1.875rem;font-weight:600;margin-bottom:1.5rem}input{width:100%;padding:.75rem 1rem;border:1px solid #e2e8f0;border-radius:.5rem;font-size:.875rem;margin-bottom:1rem;box-sizing:border-box}input:focus{border-color:#2563eb;outline:none;box-shadow:0 0 0 3px rgba(37,99,235,.1)}button{width:100%;padding:.75rem 1rem;border:none;border-radius:.5rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s;margin-bottom:1rem}.login-btn{background:#2563eb;color:#fff}.login-btn:hover{background:#1d4ed8}.google-btn{background:#fff;color:#1e293b;border:1px solid #e2e8f0;display:flex;align-items:center;justify-content:center;gap:.5rem}.google-btn:hover{background:#f8fafc}.google-icon{width:18px;height:18px}.remember-me{display:flex;align-items:center;gap:.5rem;margin:1rem 0;color:#64748b;font-size:.875rem}.remember-me input{width:auto;margin:0}.error{color:#ef4444;font-size:.875rem;margin-top:.5rem;text-align:left}a{color:#2563eb;text-decoration:none;font-size:.875rem;font-weight:500}a:hover{text-decoration:underline}\n/*$vite$:1*/",document.head.appendChild(e),window.extendSession=n,"undefined"!=typeof ErrorHandler&&ErrorHandler.setupGlobalErrorHandling&&ErrorHandler.setupGlobalErrorHandling(),localStorage.removeItem("loginAttempts"),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("loginAttempts");e&&(e.textContent="",e.style.display="none")});const t=["localhost","127.0.0.1"].includes(window.location.hostname),m=Boolean(window.CONFIG?.security?.allowUnverifiedLocalLogin)&&t,c=new Set((window.CONFIG?.security?.allowUnverifiedAccounts||[]).map(e=>e.toLowerCase()));t&&(document.getElementById("email").value="testuser@BFH.com",document.getElementById("password").value="test1234");let g=0;function u(e,t){const n=document.getElementById(e);n&&(n.textContent=t,n.style.color="#ef4444",n.style.fontSize="0.875rem",n.style.marginTop="0.25rem")}document.getElementById("loginForm").onsubmit=async function(e){e&&e.preventDefault();const t=document.getElementById("email"),n=document.getElementById("password"),s=document.getElementById("rememberMe").checked,d=document.getElementById("loginBtn"),y=d.querySelector(".btn-text"),f=d.querySelector(".btn-spinner");document.getElementById("emailError").textContent="",document.getElementById("passwordError").textContent="",document.getElementById("error").textContent="";try{let e;try{if("undefined"!=typeof ValidationUtils&&ValidationUtils.validateEmail)e=ValidationUtils.validateEmail(t.value);else{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value))throw new Error("Please enter a valid email address");e=t.value.toLowerCase().trim()}}catch(p){return u("emailError",p.message),d.disabled=!1,y.style.display="inline",void(f.style.display="none")}const h=n.value;if(!h)return void u("passwordError","Password is required");d.disabled=!0,y.style.display="none",f.style.display="inline",await i(o,s?l:a);const w=await r(e,h);if(!w){const e="Login failed. Please check your credentials and try again.";return"undefined"!=typeof ErrorHandler&&ErrorHandler.showError?ErrorHandler.showError(e):document.getElementById("error").textContent=e,d.disabled=!1,y.style.display="inline",void(f.style.display="none")}const b=(w.email||"").toLowerCase(),E=m||c.has(b);if(!w.emailVerified&&!E){const e="Please verify your email before signing in.";return"undefined"!=typeof ErrorHandler&&ErrorHandler.showWarning?ErrorHandler.showWarning(e):document.getElementById("error").textContent=e,d.disabled=!1,y.style.display="inline",void(f.style.display="none")}if(w){g=0,localStorage.removeItem("loginAttempts");const e=document.getElementById("loginAttempts");e&&(e.textContent=""),sessionStorage.setItem("login-handling-redirect","true"),sessionStorage.removeItem("auth-redirect-done"),sessionStorage.setItem("last-auth-redirect-time",Date.now().toString());const t="Login successful! Redirecting...";"undefined"!=typeof ErrorHandler&&ErrorHandler.showSuccess?ErrorHandler.showSuccess(t):(document.getElementById("error").textContent=t,document.getElementById("error").style.color="#10b981");let n="../../index.html";const o=window.location.pathname;n=o.includes("/src/pages/auth/")||o.includes("/auth/")?"../../index.html":"/login.html"===o||o.endsWith("/login.html")?"index.html":"/index.html",setTimeout(()=>{try{window.location.replace(n)}catch(e){window.location.replace(window.location.origin+"/index.html")}},500)}}catch(h){if(h.message.includes("email"))u("emailError",h.message);else if(h.message.includes("password"))u("passwordError",h.message);else if("undefined"!=typeof ErrorHandler&&ErrorHandler.handleFirebaseError)ErrorHandler.handleFirebaseError(h);else{const e=document.getElementById("error");e&&(e.textContent=h.message||"An error occurred. Please try again.")}}finally{d.disabled=!1,y.style.display="inline",f.style.display="none"}},document.getElementById("googleLoginBtn").onclick=function(){const e=new s;d(o,e).then(()=>{g=0,localStorage.removeItem("loginAttempts"),document.getElementById("loginAttempts").textContent="",sessionStorage.setItem("login-handling-redirect","true"),sessionStorage.removeItem("auth-redirect-done"),sessionStorage.setItem("last-auth-redirect-time",Date.now().toString());let e="../../index.html";const t=window.location.pathname;e=t.includes("/src/pages/auth/")||t.includes("/auth/")?"../../index.html":"/login.html"===t||t.endsWith("/login.html")?"index.html":"/index.html",setTimeout(()=>{try{window.location.replace(e)}catch(t){window.location.replace(window.location.origin+"/index.html")}},500)}).catch(e=>{const t=document.getElementById("error");t&&("undefined"!=typeof ErrorHandler&&ErrorHandler.handleFirebaseError?ErrorHandler.handleFirebaseError(e):t.innerText=e.message||"Google login failed")})},window.addEventListener("load",()=>{g=0,localStorage.removeItem("loginAttempts"),document.getElementById("loginAttempts").textContent="",document.getElementById("loginAttempts").style.display="none"})}}});
