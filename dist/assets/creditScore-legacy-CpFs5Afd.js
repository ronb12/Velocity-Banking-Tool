System.register(["./modulepreload-polyfill-legacy-CnvmjJHj.js","./theme-legacy-Bd_heFTc.js","./auth-legacy-CXkRVKZL.js","./config-legacy-CFYw0t9_.js","./vendor-utils-legacy-BZiHMGip.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"],function(e,t){"use strict";var n,o,i,r,a,s,c,d;return{setters:[null,null,null,null,null,e=>{n=e.collection,o=e.query,i=e.orderBy,r=e.limit,a=e.getDocs,s=e.doc,c=e.getDoc,d=e.setDoc},null,null],execute:function(){const e=["localhost","127.0.0.1"].includes(window.location.hostname),t=!e,l=.35,u=.3,m=.15,y=.1,p=.1;let g=[],h=null,f=null,E=720;function v(){try{const n=localStorage.getItem("creditScoreHistory");if(n)g=JSON.parse(n);else if(e){g=w();try{localStorage.setItem("creditScoreHistory",JSON.stringify(g))}catch(t){}}else g=[]}catch(n){g=e?w():[]}}function w(){const e=new Date,t=[];for(let n=6;n>=0;n--){const o=new Date(e);o.setMonth(o.getMonth()-n);const i=(6-n)/6,r=10*(Math.random()-.5),a=Math.round(680+40*i+r),s=Math.max(300,Math.min(850,a));t.push({score:s,timestamp:o.toISOString(),factors:{paymentHistory:0===n?100:Math.max(95,100-2*(6-n)),utilization:0===n?30:Math.min(45,30+3*(6-n)),historyLength:5+.1*(6-n),inquiries:0===n?2:Math.min(4,2+.3*(6-n)),creditMix:0===n?"good":n<3?"fair":"poor",derogatoryMarks:0}})}return t}async function x(){let e=null;if(t&&auth.currentUser)try{const t=s(db,"debts",auth.currentUser.uid),n=await c(t);if(n.exists()){const t=(n.data().debts||[]).filter(e=>"credit"===e.type),o=t.reduce((e,t)=>e+(parseFloat(t.limit)||0),0),i=t.reduce((e,t)=>e+(parseFloat(t.balance)||0),0);o>0&&(e=i/o*100)}}catch(n){}if(null===e)try{const t=JSON.parse(localStorage.getItem("local_test_debts")||"[]").filter(e=>"credit"===e.type),n=t.reduce((e,t)=>e+(parseFloat(t.limit)||0),0),o=t.reduce((e,t)=>e+(parseFloat(t.balance)||0),0);n>0&&(e=o/n*100)}catch(n){}if(null===e&&window.getLocalTestData)try{const t=(window.getLocalTestData("debts")||[]).filter(e=>"credit"===e.type),n=t.reduce((e,t)=>e+(parseFloat(t.limit)||0),0),o=t.reduce((e,t)=>e+(parseFloat(t.balance)||0),0);n>0&&(e=o/n*100)}catch(n){}null!==e?(document.getElementById("utilization").value=Math.round(e),document.getElementById("utilizationVal").textContent=`${Math.round(e)}%`,document.getElementById("utilizationSync").style.display="inline-flex",S(),"undefined"!=typeof ErrorHandler&&ErrorHandler.showSuccess?ErrorHandler.showSuccess("Credit utilization synced from Debt Tracker!"):window.ErrorHandler&&window.ErrorHandler.showSuccess&&window.ErrorHandler.showSuccess("Credit utilization synced from Debt Tracker!")):"undefined"!=typeof ErrorHandler&&ErrorHandler.showWarning?ErrorHandler.showWarning("No credit card data found in Debt Tracker."):window.ErrorHandler&&window.ErrorHandler.showWarning&&window.ErrorHandler.showWarning("No credit card data found in Debt Tracker.")}function I(){const e=parseInt(document.getElementById("paymentHistory").value),t=parseFloat(document.getElementById("utilization").value),n=parseFloat(document.getElementById("historyLength").value),o=parseInt(document.getElementById("inquiries").value),i=document.getElementById("creditMix").value;let r=850;return r-=e>=99?0:e>=97?20:e>=95?40:e>=90?80:e>=85?120:180,r-=t<=5?0:t<=10?20:t<=20?40:t<=30?60:t<=40?100:t<=50?140:t<=70?180:220,r-=n>=10?0:n>=7?20:n>=5?40:n>=3?60:n>=1?100:150,r-="excellent"===i?0:"good"===i?15:"fair"===i?30:50,r-=0===o?0:o<=1?10:o<=2?25:o<=4?50:o<=6?80:120,r-=40*parseInt(document.getElementById("derogatoryMarks").value),Math.max(300,Math.min(850,Math.round(r)))}function B(){return{paymentHistory:parseInt(document.getElementById("paymentHistory").value),utilization:parseFloat(document.getElementById("utilization").value),historyLength:parseFloat(document.getElementById("historyLength").value),inquiries:parseInt(document.getElementById("inquiries").value),creditMix:document.getElementById("creditMix").value,derogatoryMarks:parseInt(document.getElementById("derogatoryMarks").value)}}function b(e){return e<580?{label:"Poor",class:"poor",color:"#dc2626"}:e<670?{label:"Fair",class:"fair",color:"#f59e0b"}:e<740?{label:"Good",class:"good",color:"#10b981"}:e<800?{label:"Very Good",class:"very-good",color:"#3b82f6"}:{label:"Excellent",class:"excellent",color:"#8b5cf6"}}function S(){E=I();const e=b(E);document.getElementById("scoreNumber").textContent=E,document.getElementById("scoreRange").textContent=e.label,document.getElementById("scoreRange").className=`score-range ${e.class}`,function(e,t){const n=document.getElementById("scoreGauge").getContext("2d");h&&h.destroy();const o=(e-300)/550*100;h=new Chart(n,{type:"doughnut",data:{datasets:[{data:[o,100-o],backgroundColor:[t.color,"#e2e8f0"],borderWidth:0}]},options:{cutout:"75%",plugins:{legend:{display:!1},tooltip:{enabled:!1}},responsive:!0,maintainAspectRatio:!0}})}(E,e),function(){const e=B(),t=document.getElementById("factorBreakdown");t.innerHTML="",[{name:"Payment History",value:e.paymentHistory,max:100,unit:"%",weight:l},{name:"Credit Utilization",value:e.utilization,max:100,unit:"%",weight:u,reverse:!0},{name:"History Length",value:e.historyLength,max:20,unit:" years",weight:m},{name:"Credit Mix",value:F(e.creditMix),max:100,unit:"%",weight:y},{name:"Inquiries",value:Math.max(0,100-10*e.inquiries),max:100,unit:"%",weight:p}].forEach(e=>{const n=document.createElement("div");n.className="factor-item";let o=e.value,i=e.value/e.max*100;e.reverse&&(i=100-i),n.innerHTML=`\n          <span class="factor-name">${e.name}</span>\n          <div class="factor-bar">\n            <div class="factor-bar-fill" style="width: ${i}%"></div>\n          </div>\n          <span class="factor-value">${o}${e.unit}</span>\n        `,t.appendChild(n)})}(),function(){const e=B(),t=[],n=document.getElementById("recommendationsList");if(n.innerHTML="",e.paymentHistory<100&&t.push({priority:"High",text:`Improve payment history from ${e.paymentHistory}% to 100%`,impact:`Could improve score by ${Math.round(.5*(100-e.paymentHistory))} points`,action:"Set up automatic payments for all bills"}),e.utilization>30){const n=30,o=(e.utilization-n)/100;t.push({priority:"High",text:`Reduce credit utilization from ${e.utilization.toFixed(1)}% to ${n}%`,impact:`Could improve score by ${Math.round(1.5*(e.utilization-n))} points`,action:`Pay down approximately $${Math.round(1e4*o)} in credit card debt`})}else e.utilization>10&&t.push({priority:"Medium",text:`Lower utilization from ${e.utilization.toFixed(1)}% to below 10% for optimal score`,impact:`Could improve score by ${Math.round(1*(e.utilization-10))} points`,action:"Pay down additional credit card balances"});e.historyLength<7&&t.push({priority:"Low",text:`Build credit history (currently ${e.historyLength} years)`,impact:"Score will improve naturally as accounts age",action:"Keep old accounts open and use them occasionally"}),e.inquiries>2&&t.push({priority:"Medium",text:`Limit new credit applications (${e.inquiries} inquiries in last 12 months)`,impact:"Each inquiry can lower score by 5-10 points temporarily",action:"Avoid applying for new credit for 6-12 months"}),"poor"!==e.creditMix&&"fair"!==e.creditMix||t.push({priority:"Low",text:`Diversify credit mix (currently ${e.creditMix})`,impact:"Could improve score by 10-20 points",action:"Consider adding a different type of credit (e.g., installment loan)"}),0!==t.length?(document.getElementById("recommendationsSection").style.display="block",t.forEach(e=>{const t=document.createElement("div");t.className="recommendation-item",t.innerHTML=`\n          <span class="recommendation-priority">${e.priority}</span>\n          <div class="recommendation-text">\n            <strong>${e.text}</strong>\n            <div class="recommendation-impact">${e.impact}</div>\n            <div class="recommendation-impact" style="margin-top: 4px; font-weight: 600;">Action: ${e.action}</div>\n          </div>\n        `,n.appendChild(t)})):document.getElementById("recommendationsSection").style.display="none"}(),L()}function F(e){return{excellent:100,good:75,fair:50,poor:25}[e]||50}function L(){document.getElementById("yourScore").textContent=E;const e=E-714;document.getElementById("nationalDiff").textContent=`${e>=0?"+":""}${e} points`,document.getElementById("nationalDiff").className="diff "+(e>=0?"positive":"negative");const t=E-680;document.getElementById("ageDiff").textContent=`${t>=0?"+":""}${t} points`,document.getElementById("ageDiff").className="diff "+(t>=0?"positive":"negative");const n=E-750;document.getElementById("excellentDiff").textContent=`${n>=0?"+":""}${n} points`,document.getElementById("excellentDiff").className="diff "+(n>=0?"positive":"negative")}function M(){const e=document.getElementById("historyChart");if(!e||0===g.length)return;const t=e.getContext("2d");f&&f.destroy();const n=g.map((e,t)=>new Date(g[t].timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"})),o=g.map(e=>e.score);f=new Chart(t,{type:"line",data:{labels:n,datasets:[{label:"Credit Score",data:o,borderColor:"#667eea",backgroundColor:"rgba(102, 126, 234, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!1,min:300,max:850}}}})}function H(){const e=B(),t=parseFloat(document.getElementById("scenarioDebtPaydown").value)||0,n=parseFloat(document.getElementById("scenarioUtilization").value)||e.utilization,o=parseFloat(document.getElementById("scenarioCreditLimit").value)||0;let i=e.utilization;(t>0||o>0)&&(t>0&&(i=Math.max(0,e.utilization-t/1e4*10)),o>0&&(i=Math.max(0,i-o/1e4*5))),n!==e.utilization&&(i=n);const r=document.getElementById("utilization").value;document.getElementById("utilization").value=i;const a=I();document.getElementById("utilization").value=r;const s=a-E,c=document.getElementById("scenarioResult");c.style.display="block",c.innerHTML=`\n        <h4 style="margin: 0 0 15px 0; color: #667eea;">Scenario Results</h4>\n        <div style="font-size: 1.2em; margin-bottom: 10px;">\n          <strong>Projected Score:</strong> <span style="color: ${s>=0?"#10b981":"#ef4444"}; font-size: 1.5em; font-weight: 700;">${a}</span>\n        </div>\n        <div style="font-size: 1.1em; margin-bottom: 10px;">\n          <strong>Change:</strong> <span style="color: ${s>=0?"#10b981":"#ef4444"};">${s>=0?"+":""}${s} points</span>\n        </div>\n        <div style="color: #64748b; font-size: 0.95em;">\n          ${s>0?"This scenario would improve your score!":s<0?"This scenario would lower your score.":"No significant change expected."}\n        </div>\n      `}let $=null;async function z(){try{const e=await async function(){return window.jspdf&&window.jspdf.jsPDF?window.jspdf.jsPDF:$||($=new Promise((e,t)=>{const n=document.querySelector('script[data-jspdf="true"]');if(n)return n.addEventListener("load",()=>{window.jspdf&&window.jspdf.jsPDF?e(window.jspdf.jsPDF):t(new Error("jsPDF loaded but constructor missing"))}),void n.addEventListener("error",()=>t(new Error("Failed to load jsPDF script")));const o=document.createElement("script");o.src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js",o.async=!0,o.dataset.jspdf="true",o.addEventListener("load",()=>{window.jspdf&&window.jspdf.jsPDF?e(window.jspdf.jsPDF):t(new Error("jsPDF loaded but constructor missing"))}),o.onerror=()=>t(new Error("Failed to load jsPDF script")),document.head.appendChild(o)}),$)}();if(!e)throw new Error("Unable to load jsPDF library");const t=B(),n=b(E),o=new e({unit:"pt",format:"letter"}),i=o.internal.pageSize.getWidth(),r=o.internal.pageSize.getHeight(),a=72,s=90,c=s+30;let d=c;o.setFillColor(102,126,234),o.rect(0,0,i,s,"F"),o.setTextColor(255,255,255),o.setFontSize(24),o.setFont("helvetica","bold"),o.text("Credit Score Estimate Report",a,45),o.setFontSize(12),o.setFont("helvetica","normal"),o.text(`Generated: ${(new Date).toLocaleDateString()}`,a,70),d=c,o.setTextColor(30,41,59),o.setFontSize(20),o.setFont("helvetica","bold"),o.text(`Estimated Score: ${E}`,a,d),d+=25,o.setFontSize(14),o.setFont("helvetica","normal"),o.setTextColor(102,126,234),o.text(`Status: ${n.label}`,a,d),d+=30,o.setTextColor(30,41,59),o.setFontSize(16),o.setFont("helvetica","bold"),o.text("Factor Breakdown",a,d),d+=25,o.setFontSize(11),o.setFont("helvetica","normal"),[`Payment History: ${t.paymentHistory}% (Weight: 35%)`,`Credit Utilization: ${t.utilization.toFixed(1)}% (Weight: 30%)`,`Credit History Length: ${t.historyLength} years (Weight: 15%)`,`Credit Inquiries: ${t.inquiries} (Weight: 10%)`,`Credit Mix: ${t.creditMix} (Weight: 10%)`,`Derogatory Marks: ${t.derogatoryMarks}`].forEach(e=>{d>r-100&&(o.addPage(),d=a),o.text(e,a+20,d),d+=20}),d+=15,d>r-120&&(o.addPage(),d=a),o.setFontSize(16),o.setFont("helvetica","bold"),o.text("Comparisons",a,d),d+=25,o.setFontSize(11),o.setFont("helvetica","normal");const l=E-714,u=E-680,m=E-750;o.text(`National Average: 714 (${l>=0?"+":""}${l} points)`,a+20,d),d+=20,o.text(`Age Group Average (25-34): 680 (${u>=0?"+":""}${u} points)`,a+20,d),d+=20,o.text(`Excellent Range: 750+ (${m>=0?"+":""}${m} points)`,a+20,d),d+=25,d>r-80&&(o.addPage(),d=a),o.setFontSize(10),o.setTextColor(100,116,139);const y="Note: This is an estimate only. Always check your official credit report for your actual score.",p=o.splitTextToSize(y,i-2*a);o.text(p,a,d),d+=15*p.length+10,o.text("Generated by Bradley's Financial Tools",a,d),o.save(`credit-score-report-${(new Date).toISOString().split("T")[0]}.pdf`),"undefined"!=typeof ErrorHandler&&ErrorHandler.showSuccess?ErrorHandler.showSuccess("PDF report exported successfully!"):window.ErrorHandler&&window.ErrorHandler.showSuccess&&window.ErrorHandler.showSuccess("PDF report exported successfully!")}catch(e){"undefined"!=typeof ErrorHandler&&ErrorHandler.showError?ErrorHandler.showError("Failed to export PDF. Please try again."):window.ErrorHandler&&window.ErrorHandler.showError?window.ErrorHandler.showError("Failed to export PDF. Please try again."):alert("Failed to export PDF. Please try again.")}}function C(){const n=document.getElementById("paymentHistory"),o=document.getElementById("utilization");n&&n.addEventListener("input",function(){const e=document.getElementById("paymentHistoryVal");e&&(e.textContent=`${this.value}%`),S()}),o&&o.addEventListener("input",function(){const e=document.getElementById("utilizationVal");e&&(e.textContent=`${this.value}%`),S()}),["historyLength","inquiries","creditMix","derogatoryMarks"].forEach(e=>{const t=document.getElementById(e);t&&(t.addEventListener("input",S),t.addEventListener("change",S))});const i=document.getElementById("syncDataBtn");i&&i.addEventListener("click",x);const r=document.getElementById("helpBtn");r&&r.addEventListener("click",()=>{const e=document.getElementById("helpModal");e&&e.classList.add("active")});const a=document.getElementById("scenarioBtn");a&&a.addEventListener("click",()=>{const e=document.getElementById("scenarioModal");e&&(e.classList.add("active"),document.getElementById("scenarioDebtPaydown").value="0",document.getElementById("scenarioUtilization").value="30",document.getElementById("scenarioCreditLimit").value="0",document.getElementById("scenarioResult").style.display="none")});const c=document.getElementById("historyBtn");c&&c.addEventListener("click",()=>{const t=document.getElementById("historyModal");t&&(t.classList.add("active"),e&&0===g.length&&v(),setTimeout(()=>{g.length>0?M():e&&(g=w(),M())},100))});const l=document.getElementById("compareBtn");l&&l.addEventListener("click",()=>{const e=document.getElementById("comparisonModal");e&&(e.classList.add("active"),L())});const u=document.getElementById("creditFactorsBtn");u&&u.addEventListener("click",()=>{const e=document.getElementById("creditFactorsModal");e&&e.classList.add("active")});const m=document.getElementById("exportBtn");m&&m.addEventListener("click",z);const y=document.getElementById("saveBtn");y&&y.addEventListener("click",()=>{!function(){const e={score:E,timestamp:(new Date).toISOString(),factors:B()};if(g.push(e),g.length>12&&(g=g.slice(-12)),t&&auth.currentUser)try{d(s(db,"creditScores",`${auth.currentUser.uid}_${Date.now()}`),e)}catch(n){}try{localStorage.setItem("creditScoreHistory",JSON.stringify(g))}catch(n){}}(),"undefined"!=typeof ErrorHandler&&ErrorHandler.showSuccess?ErrorHandler.showSuccess("Score saved successfully!"):window.ErrorHandler&&window.ErrorHandler.showSuccess?window.ErrorHandler.showSuccess("Score saved successfully!"):alert("Score saved successfully!")});const p=document.getElementById("runScenarioBtn");p&&p.addEventListener("click",H)}function D(){C(),function(){document.querySelectorAll(".close-modal").forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("data-close"),t=document.getElementById(e);t&&t.classList.remove("active")})});const e=document.getElementById("helpModal");e&&e.addEventListener("click",function(e){e.target===this&&this.classList.remove("active")});const t=document.getElementById("scenarioModal");t&&t.addEventListener("click",function(e){e.target===this&&this.classList.remove("active")});const n=document.getElementById("historyModal");n&&n.addEventListener("click",function(e){e.target===this&&this.classList.remove("active")});const o=document.getElementById("comparisonModal");o&&o.addEventListener("click",function(e){e.target===this&&this.classList.remove("active")});const i=document.getElementById("creditFactorsModal");i&&i.addEventListener("click",function(e){e.target===this&&this.classList.remove("active")})}(),async function(){if(t&&auth.currentUser)try{const e=n(db,"creditScores"),t=o(e,i("timestamp","desc"),r(12)),s=await a(t);g=s.docs.map(e=>({...e.data(),id:e.id})).reverse()}catch(e){v()}else v();return Promise.resolve()}().then(()=>{S(),e&&setTimeout(x,1e3)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",D):D()}}});
