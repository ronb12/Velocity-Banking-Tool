var e,t,n,o;function r(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}import"./modulepreload-polyfill-YP0FEG5d.js";/* empty css              */import"./config-BVEHcmK7.js";import"./validation-DH8JBn6E.js";import"./vendor-utils-D8RwcFva.js";import{e as i,a as l,l as s}from"./auth-D-ZYIE7C.js";import{setPersistence as a,browserLocalPersistence as d,browserSessionPersistence as m,GoogleAuthProvider as c,signInWithPopup as u}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";import"https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";import"https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";window.extendSession=i,"undefined"!=typeof ErrorHandler&&ErrorHandler.setupGlobalErrorHandling&&ErrorHandler.setupGlobalErrorHandling(),localStorage.removeItem("loginAttempts"),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("loginAttempts");e&&(e.textContent="",e.style.display="none")});const g=["localhost","127.0.0.1"].includes(window.location.hostname),y=Boolean(null==(t=null==(e=window.CONFIG)?void 0:e.security)?void 0:t.allowUnverifiedLocalLogin)&&g,p=new Set(((null==(o=null==(n=window.CONFIG)?void 0:n.security)?void 0:o.allowUnverifiedAccounts)||[]).map(e=>e.toLowerCase()));g&&(document.getElementById("email").value="testuser@BFH.com",document.getElementById("password").value="test1234");let w=0;function E(e,t){const n=document.getElementById(e);n&&(n.textContent=t,n.style.color="#ef4444",n.style.fontSize="0.875rem",n.style.marginTop="0.25rem")}document.getElementById("loginForm").onsubmit=async function(e){e&&e.preventDefault();const t=document.getElementById("email"),n=document.getElementById("password"),o=document.getElementById("rememberMe").checked,r=document.getElementById("loginBtn"),i=r.querySelector(".btn-text"),c=r.querySelector(".btn-spinner");document.getElementById("emailError").textContent="",document.getElementById("passwordError").textContent="",document.getElementById("error").textContent="";try{let e;try{if("undefined"!=typeof ValidationUtils&&ValidationUtils.validateEmail)e=ValidationUtils.validateEmail(t.value);else{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value))throw new Error("Please enter a valid email address");e=t.value.toLowerCase().trim()}}catch(u){return E("emailError",u.message),r.disabled=!1,i.style.display="inline",void(c.style.display="none")}const g=n.value;if(!g)return void E("passwordError","Password is required");r.disabled=!0,i.style.display="none",c.style.display="inline",await a(l,o?d:m);const h=await s(e,g);if(!h){const e="Login failed. Please check your credentials and try again.";return"undefined"!=typeof ErrorHandler&&ErrorHandler.showError?ErrorHandler.showError(e):document.getElementById("error").textContent=e,r.disabled=!1,i.style.display="inline",void(c.style.display="none")}const f=(h.email||"").toLowerCase(),I=y||p.has(f);if(!h.emailVerified&&!I){const e="Please verify your email before signing in.";return"undefined"!=typeof ErrorHandler&&ErrorHandler.showWarning?ErrorHandler.showWarning(e):document.getElementById("error").textContent=e,r.disabled=!1,i.style.display="inline",void(c.style.display="none")}if(h){w=0,localStorage.removeItem("loginAttempts");const e=document.getElementById("loginAttempts");e&&(e.textContent=""),sessionStorage.setItem("login-handling-redirect","true"),sessionStorage.removeItem("auth-redirect-done"),sessionStorage.setItem("last-auth-redirect-time",Date.now().toString());const t="Login successful! Redirecting...";"undefined"!=typeof ErrorHandler&&ErrorHandler.showSuccess?ErrorHandler.showSuccess(t):(document.getElementById("error").textContent=t,document.getElementById("error").style.color="#10b981");let n="../../index.html";const o=window.location.pathname;n=o.includes("/src/pages/auth/")||o.includes("/auth/")?"../../index.html":"/login.html"===o||o.endsWith("/login.html")?"index.html":"/index.html",setTimeout(()=>{try{window.location.replace(n)}catch(e){window.location.replace(window.location.origin+"/index.html")}},500)}}catch(g){if(g.message.includes("email"))E("emailError",g.message);else if(g.message.includes("password"))E("passwordError",g.message);else if("undefined"!=typeof ErrorHandler&&ErrorHandler.handleFirebaseError)ErrorHandler.handleFirebaseError(g);else{const e=document.getElementById("error");e&&(e.textContent=g.message||"An error occurred. Please try again.")}}finally{r.disabled=!1,i.style.display="inline",c.style.display="none"}},document.getElementById("googleLoginBtn").onclick=function(){const e=new c;u(l,e).then(()=>{w=0,localStorage.removeItem("loginAttempts"),document.getElementById("loginAttempts").textContent="",sessionStorage.setItem("login-handling-redirect","true"),sessionStorage.removeItem("auth-redirect-done"),sessionStorage.setItem("last-auth-redirect-time",Date.now().toString());let e="../../index.html";const t=window.location.pathname;e=t.includes("/src/pages/auth/")||t.includes("/auth/")?"../../index.html":"/login.html"===t||t.endsWith("/login.html")?"index.html":"/index.html",setTimeout(()=>{try{window.location.replace(e)}catch(t){window.location.replace(window.location.origin+"/index.html")}},500)}).catch(e=>{const t=document.getElementById("error");t&&("undefined"!=typeof ErrorHandler&&ErrorHandler.handleFirebaseError?ErrorHandler.handleFirebaseError(e):t.innerText=e.message||"Google login failed")})},window.addEventListener("load",()=>{w=0,localStorage.removeItem("loginAttempts"),document.getElementById("loginAttempts").textContent="",document.getElementById("loginAttempts").style.display="none"});export{r as __vite_legacy_guard};
