function t(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}import"./modulepreload-polyfill-YP0FEG5d.js";import"./auth-D-ZYIE7C.js";import"./config-BVEHcmK7.js";/* empty css              */import{doc as e,updateDoc as n,deleteDoc as i,query as a,collection as o,getDocs as s,orderBy as c,where as r,addDoc as d,Timestamp as l}from"https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";import"https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";import"https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";let m=[];const u=["localhost","127.0.0.1"].includes(window.location.hostname);function f(t){var e,n;if(!t||!t.email)return!1;return((null==(n=null==(e=window.CONFIG)?void 0:e.security)?void 0:n.allowUnverifiedAccounts)||[]).map(t=>t.toLowerCase()).includes(t.email.toLowerCase())}async function p(t){if(!f(t))return!1;try{const e=o(db,"users",t.uid,"notifications");if((await s(e)).empty){const t=function(){const t=Date.now();return[{message:"Welcome to Bradley's Financial Tools! üéâ Start tracking your finances today.",timestamp:t-1728e5,read:!1},{message:"Your savings goal is 25% complete! Keep up the great work! üí∞",timestamp:t-1296e5,read:!1},{message:"Payment reminder: Credit card payment due in 3 days. üí≥",timestamp:t-864e5,read:!1},{message:"Budget alert: You've spent 80% of your monthly budget. ‚ö†Ô∏è",timestamp:t-432e5,read:!1},{message:"Congratulations! You paid off $500 in debt this month! üéØ",timestamp:t-36e6,read:!1},{message:"New feature: Check out the Velocity Banking Calculator! üöÄ",timestamp:t-288e5,read:!0},{message:"Your net worth increased by $1,200 this month! üìà",timestamp:t-216e5,read:!0},{message:"Reminder: Review your monthly financial goals. üìä",timestamp:t-144e5,read:!1},{message:"Success: All bills paid on time this month! ‚úÖ",timestamp:t-72e5,read:!0},{message:"Tip: Use the debt tracker to visualize your progress. üí°",timestamp:t-36e5,read:!1},{message:"Alert: Your emergency fund reached $5,000! üéä",timestamp:t-18e5,read:!1},{message:"Update: Your credit score improved by 15 points! üìà",timestamp:t-9e5,read:!0}]}().map(t=>d(e,{message:t.message,timestamp:l.fromMillis(t.timestamp),read:t.read,category:"info"}));return await Promise.all(t),!0}}catch(e){}return!1}function g(){var t;try{const t=localStorage.getItem("local_test_notifications");if(t)return JSON.parse(t)}catch(i){}const e=window.getLocalTestData&&window.getLocalTestData("notifications")||(null==(t=window.LOCAL_TEST_DATA)?void 0:t.notifications)||[];return n=e,JSON.parse(JSON.stringify(n));var n}function y(t){try{localStorage.setItem("local_test_notifications",JSON.stringify(t))}catch(e){}}function h(t="all"){const e=document.getElementById("notifications"),n=document.getElementById("loading"),i=g();if(n.style.display="none",e.style.display="block",m=i.map((t,e)=>({id:t.id||"local-".concat(e,"-").concat(Date.now()),message:t.message||"Notification",timestamp:t.timestamp||Date.now(),read:void 0!==t.read&&t.read,category:t.category||"info"})),E(),0===m.length)return void(e.innerHTML='\n          <div class="empty-state">\n            <div style="font-size: 4em; margin-bottom: 20px;">üîî</div>\n            <h3>No notifications found</h3>\n            <p>You\'re all caught up! New notifications will appear here.</p>\n          </div>\n        ');const a=m.filter(e=>"unread"===t?!e.read:"read"!==t||e.read);0!==a.length?(e.innerHTML="",a.forEach(t=>{const n=document.createElement("div");n.className="notification ".concat(t.read?"":"unread");const i=w(t.message||""),a=b(t.message||""),o=(s=t)&&s.timestamp?"number"==typeof s.timestamp?new Date(s.timestamp).toLocaleString():s.timestamp.seconds?new Date(1e3*s.timestamp.seconds).toLocaleString():new Date(s.timestamp).toLocaleString():"Just now";var s;n.innerHTML='\n          <div class="notification-header">\n            <div>\n              <span class="notification-type '.concat(i,'">').concat(i.replace("type-",""),'</span>\n              <div class="notification-message">\n                <span style="font-size: 1.2em; margin-right: 8px;">').concat(a,"</span>\n                ").concat(t.message||"Notification",'\n              </div>\n            </div>\n          </div>\n          <div class="notification-time">').concat(o,'</div>\n          <div class="notification-actions">\n            ').concat(t.read?"":'<button class="btn btn-primary" onclick="markAsRead(\''.concat(t.id,"')\">‚úÖ Mark as Read</button>"),'\n            <button class="btn btn-secondary" onclick="deleteNotification(\'').concat(t.id,"')\">üóëÔ∏è Delete</button>\n          </div>\n        "),e.appendChild(n)})):e.innerHTML='\n          <div class="empty-state">\n            <div style="font-size: 4em; margin-bottom: 20px;">üîî</div>\n            <h3>No '.concat("unread"===t?"unread":"read"===t?"read":""," notifications found</h3>\n            <p>Try changing the filter to see more notifications.</p>\n          </div>\n        ")}function v(t,e="success"){const n=document.getElementById("toast");n.innerText=t,n.className="toast ".concat(e),n.style.visibility="visible",n.style.opacity="1",setTimeout(()=>{n.style.opacity="0",n.style.visibility="hidden"},3e3)}function w(t){return t.includes("success")||t.includes("completed")||t.includes("achieved")?"type-success":t.includes("warning")||t.includes("caution")||t.includes("attention")?"type-warning":t.includes("error")||t.includes("failed")||t.includes("problem")?"type-error":"type-info"}function b(t){return t.includes("goal")||t.includes("target")?"üéØ":t.includes("payment")||t.includes("debt")?"üí≥":t.includes("budget")||t.includes("spending")?"üí∞":t.includes("savings")||t.includes("saved")?"üíµ":t.includes("reminder")||t.includes("due")?"‚è∞":t.includes("welcome")||t.includes("account")?"üëã":"üì¢"}function E(){const t=m.length,e=m.filter(t=>!t.read).length,n=t-e;document.getElementById("totalNotifications").textContent=t,document.getElementById("unreadNotifications").textContent=e,document.getElementById("readNotifications").textContent=n}async function N(t){const e=document.getElementById("notifications"),n=document.getElementById("loading"),i=document.getElementById("notifFilter").value;if(e.innerHTML="",n.style.display="block",e.style.display="block",u)h(i);else try{if(f(t)){const e=o(db,"users",t.uid,"notifications");if((await s(e)).empty){if(await p(t))return void(await N(t))}}let d=a(o(db,"users",t.uid,"notifications"),c("timestamp","desc"));"unread"===i?d=a(d,r("read","==",!1)):"read"===i&&(d=a(d,r("read","==",!0)));const l=await s(d);if(n.style.display="none",e.style.display="block",m=[],l.forEach(t=>{m.push({id:t.id,...t.data()})}),E(),0===m.length)return void(e.innerHTML='\n            <div class="empty-state">\n              <div style="font-size: 4em; margin-bottom: 20px;">üîî</div>\n              <h3>No notifications found</h3>\n              <p>You\'re all caught up! New notifications will appear here.</p>\n            </div>\n          ');const u=m.filter(t=>"unread"===i?!t.read:"read"!==i||t.read);if(0===u.length)return void(e.innerHTML='\n            <div class="empty-state">\n              <div style="font-size: 4em; margin-bottom: 20px;">üîî</div>\n              <h3>No '.concat("unread"===i?"unread":"read"===i?"read":""," notifications found</h3>\n              <p>Try changing the filter to see more notifications.</p>\n            </div>\n          "));e.innerHTML="",u.forEach(t=>{const n=document.createElement("div");n.className="notification ".concat(t.read?"":"unread");const i=w(t.message),a=b(t.message),o=t.timestamp?new Date(1e3*t.timestamp.seconds).toLocaleString():"Just now";n.innerHTML='\n            <div class="notification-header">\n              <div>\n                <span class="notification-type '.concat(i,'">').concat(i.replace("type-",""),'</span>\n                <div class="notification-message">\n                  <span style="font-size: 1.2em; margin-right: 8px;">').concat(a,"</span>\n                  ").concat(t.message,'\n                </div>\n              </div>\n            </div>\n            <div class="notification-time">').concat(o,'</div>\n            <div class="notification-actions">\n              ').concat(t.read?"":'<button class="btn btn-primary" onclick="markAsRead(\''.concat(t.id,"')\">‚úÖ Mark as Read</button>"),'\n              <button class="btn btn-secondary" onclick="deleteNotification(\'').concat(t.id,"')\">üóëÔ∏è Delete</button>\n            </div>\n          "),e.appendChild(n)})}catch(d){n.style.display="none",e.innerHTML='\n          <div class="empty-state">\n            <div style="font-size: 4em; margin-bottom: 20px;">‚ùå</div>\n            <h3>Error loading notifications</h3>\n            <p>Please try refreshing the page.</p>\n          </div>\n        '}}window.markAsRead=async function(t){const i=auth.currentUser;if(i||u){if(u){const e=g(),n=e.findIndex(e=>e.id===t);return void(n>=0&&(e[n].read=!0,y(e),v("Notification marked as read","success"),h(document.getElementById("notifFilter").value)))}try{const a=e(db,"users",i.uid,"notifications",t);await n(a,{read:!0}),v("Notification marked as read","success"),N(i)}catch(a){v("Error marking notification as read","error")}}},window.deleteNotification=async function(t){const n=auth.currentUser;if((n||u)&&confirm("Are you sure you want to delete this notification?")){if(u){return y(g().filter(e=>e.id!==t)),v("Notification deleted","success"),void h(document.getElementById("notifFilter").value)}try{const a=e(db,"users",n.uid,"notifications",t);await i(a),v("Notification deleted","success"),N(n)}catch(a){v("Error deleting notification","error")}}},window.markAllAsRead=async function(){const t=auth.currentUser;if(t||u){if(u){const t=g().map(t=>({...t,read:!0}));return y(t),v("".concat(t.length," notifications marked as read"),"success"),void h(document.getElementById("notifFilter").value)}try{const i=m.filter(t=>!t.read),a=i.map(i=>{const a=e(db,"users",t.uid,"notifications",i.id);return n(a,{read:!0})});await Promise.all(a),v("".concat(i.length," notifications marked as read"),"success"),N(t)}catch(i){v("Error marking notifications as read","error")}}},window.clearAllNotifications=async function(){const t=auth.currentUser;if((t||u)&&confirm("Are you sure you want to delete ALL notifications? This action cannot be undone.")){if(u)return y([]),v("All notifications cleared","success"),void h(document.getElementById("notifFilter").value);try{const n=a(o(db,"users",t.uid,"notifications")),c=(await s(n)).docs.map(n=>i(e(db,"users",t.uid,"notifications",n.id)));await Promise.all(c),v("All notifications cleared","success"),N(t)}catch(n){v("Error clearing notifications","error")}}},document.getElementById("notifFilter").addEventListener("change",()=>{const t=auth.currentUser;t&&N(t),u&&h(document.getElementById("notifFilter").value)}),(async()=>{var t;try{const{auth:t}=await waitForAuth(1e4);window.auth=t,t.onAuthStateChanged(t=>{t?N(t):u?h(document.getElementById("notifFilter").value):(document.getElementById("notifications").innerHTML='\n              <div class="empty-state">\n                <div style="font-size: 4em; margin-bottom: 20px;">üîê</div>\n                <h3>Please log in</h3>\n                <p>You need to be logged in to view your notifications.</p>\n                <a href="/src/pages/auth/login.html" class="btn btn-primary" style="margin-top: 20px;">Login</a>\n              </div>\n            ',document.getElementById("loading").style.display="none")})}catch(e){u?h((null==(t=document.getElementById("notifFilter"))?void 0:t.value)||"all"):(document.getElementById("notifications").innerHTML='\n            <div class="empty-state">\n              <div style="font-size: 4em; margin-bottom: 20px;">üîê</div>\n              <h3>Please log in</h3>\n              <p>You need to be logged in to view your notifications.</p>\n              <a href="/src/pages/auth/login.html" class="btn btn-primary" style="margin-top: 20px;">Login</a>\n            </div>\n          ',document.getElementById("loading")&&(document.getElementById("loading").style.display="none"))}})();export{t as __vite_legacy_guard};
