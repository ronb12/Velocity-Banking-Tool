System.register(["./preload-helper-legacy-B-gntM7F.js"],function(t,e){"use strict";var i;return{setters:[t=>{i=t._}],execute:function(){const t="undefined"!=typeof window&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname);class a{constructor(){this.db=null,this.auth=null,this.isInitialized=!1}async initialize(t,e){this.db=t,this.auth=e,this.isInitialized=!0}async logActivity(a,o,n="ðŸ“",c={}){if(!t&&this.isInitialized&&this.auth.currentUser)try{const{addDoc:t,collection:s,serverTimestamp:T}=await i(async()=>{const{addDoc:t,collection:i,serverTimestamp:a}=await e.import("https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js");return{addDoc:t,collection:i,serverTimestamp:a}},void 0),l={icon:n,text:o,type:a,timestamp:T(),metadata:c,userId:this.auth.currentUser.uid};await t(s(this.db,"users",this.auth.currentUser.uid,"activity_logs"),l)}catch(s){}}static ACTIVITY_TYPES={DEBT_PAYMENT:{icon:"ðŸ’³",template:(t,e)=>`Paid $${t} towards ${e}`},DEBT_ADDED:{icon:"âž•",template:(t,e)=>`Added ${t} debt of $${e}`},DEBT_UPDATED:{icon:"âœï¸",template:t=>`Updated ${t} debt details`},DEBT_DELETED:{icon:"ðŸ—‘ï¸",template:t=>`Deleted ${t} debt`},BUDGET_CREATED:{icon:"ðŸ“Š",template:(t,e)=>`Created budget for ${t}: $${e}`},BUDGET_UPDATED:{icon:"âœï¸",template:(t,e)=>`Updated ${t} budget to $${e}`},BUDGET_SPENT:{icon:"ðŸ’¸",template:(t,e)=>`Spent $${e} on ${t}`},SAVINGS_GOAL_CREATED:{icon:"ðŸŽ¯",template:(t,e)=>`Created savings goal: ${t} ($${e})`},SAVINGS_GOAL_UPDATED:{icon:"âœï¸",template:(t,e)=>`Updated savings goal: ${t} ($${e})`},SAVINGS_GOAL_COMPLETED:{icon:"ðŸŽ‰",template:t=>`Completed savings goal: ${t}`},SAVINGS_CONTRIBUTION:{icon:"ðŸ’°",template:(t,e)=>`Added $${e} to ${t} savings goal`},NET_WORTH_UPDATED:{icon:"ðŸ“ˆ",template:(t,e)=>`Updated ${t}: $${e}`},VELOCITY_CALCULATED:{icon:"ðŸ§®",template:(t,e)=>`Calculated velocity strategy for $${t} debt with $${e} payment`},TAX_CALCULATED:{icon:"ðŸ§¾",template:(t,e)=>`Calculated ${t} taxes: $${e}`},LOGIN:{icon:"ðŸ”",template:()=>"Logged into account"},LOGOUT:{icon:"ðŸšª",template:()=>"Logged out of account"},PROFILE_UPDATED:{icon:"ðŸ‘¤",template:t=>`Updated profile ${t}`}};async logDebtPayment(t,e,i){const o=a.ACTIVITY_TYPES.DEBT_PAYMENT.template(e,t);await this.logActivity("debt_payment",o,a.ACTIVITY_TYPES.DEBT_PAYMENT.icon,{debtName:t,amount:e,remainingBalance:i})}async logDebtAdded(t,e,i){const o=a.ACTIVITY_TYPES.DEBT_ADDED.template(t,e);await this.logActivity("debt_added",o,a.ACTIVITY_TYPES.DEBT_ADDED.icon,{debtName:t,amount:e,interestRate:i})}async logBudgetCreated(t,e){const i=a.ACTIVITY_TYPES.BUDGET_CREATED.template(t,e);await this.logActivity("budget_created",i,a.ACTIVITY_TYPES.BUDGET_CREATED.icon,{category:t,amount:e})}async logBudgetUpdated(t,e,i){const o=a.ACTIVITY_TYPES.BUDGET_UPDATED.template(t,i);await this.logActivity("budget_updated",o,a.ACTIVITY_TYPES.BUDGET_UPDATED.icon,{category:t,oldAmount:e,newAmount:i})}async logSavingsGoalCreated(t,e,i){const o=a.ACTIVITY_TYPES.SAVINGS_GOAL_CREATED.template(t,e);await this.logActivity("savings_goal_created",o,a.ACTIVITY_TYPES.SAVINGS_GOAL_CREATED.icon,{goalName:t,targetAmount:e,category:i})}async logSavingsContribution(t,e,i){const o=a.ACTIVITY_TYPES.SAVINGS_CONTRIBUTION.template(t,e);await this.logActivity("savings_contribution",o,a.ACTIVITY_TYPES.SAVINGS_CONTRIBUTION.icon,{goalName:t,amount:e,progress:i})}async logNetWorthUpdate(t,e,i){const o=a.ACTIVITY_TYPES.NET_WORTH_UPDATED.template(t,e);await this.logActivity("net_worth_updated",o,a.ACTIVITY_TYPES.NET_WORTH_UPDATED.icon,{type:t,amount:e,totalNetWorth:i})}async logVelocityCalculation(t,e,i){const o=a.ACTIVITY_TYPES.VELOCITY_CALCULATED.template(t,e);await this.logActivity("velocity_calculated",o,a.ACTIVITY_TYPES.VELOCITY_CALCULATED.icon,{debtAmount:t,payment:e,strategy:i})}async logTaxCalculation(t,e,i){const o=a.ACTIVITY_TYPES.TAX_CALCULATED.template(t,e);await this.logActivity("tax_calculated",o,a.ACTIVITY_TYPES.TAX_CALCULATED.icon,{year:t,totalTax:e,netIncome:i})}async logLogin(){const t=a.ACTIVITY_TYPES.LOGIN.template();await this.logActivity("login",t,a.ACTIVITY_TYPES.LOGIN.icon)}async logLogout(){const t=a.ACTIVITY_TYPES.LOGOUT.template();await this.logActivity("logout",t,a.ACTIVITY_TYPES.LOGOUT.icon)}async getRecentActivities(t=10){if(!this.isInitialized||!this.auth.currentUser)return[];try{const{collection:a,query:o,orderBy:n,limitToLast:c,getDocs:s}=await i(async()=>{const{collection:t,query:i,orderBy:a,limitToLast:o,getDocs:n}=await e.import("https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js");return{collection:t,query:i,orderBy:a,limitToLast:o,getDocs:n}},void 0),T=o(a(this.db,"users",this.auth.currentUser.uid,"activity_logs"),n("timestamp","desc"),c(t));return(await s(T)).docs.map(t=>({id:t.id,...t.data()}))}catch(a){return[]}}}window.activityLogger=new a,document.addEventListener("DOMContentLoaded",async function(){!function t(){window.db&&window.auth?window.activityLogger.initialize(window.db,window.auth):setTimeout(t,100)}()})}}});
