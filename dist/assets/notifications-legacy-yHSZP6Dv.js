System.register(["./modulepreload-polyfill-legacy-CnvmjJHj.js","./auth-legacy-CXkRVKZL.js","./config-legacy-CFYw0t9_.js","./theme-legacy-Bd_heFTc.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js","https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"],function(e,t){"use strict";var n,i,a,s,o,r,c,d,l,m;return{setters:[null,null,null,null,e=>{n=e.doc,i=e.updateDoc,a=e.deleteDoc,s=e.query,o=e.collection,r=e.getDocs,c=e.orderBy,d=e.where,l=e.addDoc,m=e.Timestamp},null,null],execute:function(){let e=[];const t=["localhost","127.0.0.1"].includes(window.location.hostname);function u(e){return!(!e||!e.email)&&(window.CONFIG?.security?.allowUnverifiedAccounts||[]).map(e=>e.toLowerCase()).includes(e.email.toLowerCase())}async function f(e){if(!u(e))return!1;try{const t=o(db,"users",e.uid,"notifications");if((await r(t)).empty){const e=function(){const e=Date.now();return[{message:"Welcome to Bradley's Financial Tools! üéâ Start tracking your finances today.",timestamp:e-1728e5,read:!1},{message:"Your savings goal is 25% complete! Keep up the great work! üí∞",timestamp:e-1296e5,read:!1},{message:"Payment reminder: Credit card payment due in 3 days. üí≥",timestamp:e-864e5,read:!1},{message:"Budget alert: You've spent 80% of your monthly budget. ‚ö†Ô∏è",timestamp:e-432e5,read:!1},{message:"Congratulations! You paid off $500 in debt this month! üéØ",timestamp:e-36e6,read:!1},{message:"New feature: Check out the Velocity Banking Calculator! üöÄ",timestamp:e-288e5,read:!0},{message:"Your net worth increased by $1,200 this month! üìà",timestamp:e-216e5,read:!0},{message:"Reminder: Review your monthly financial goals. üìä",timestamp:e-144e5,read:!1},{message:"Success: All bills paid on time this month! ‚úÖ",timestamp:e-72e5,read:!0},{message:"Tip: Use the debt tracker to visualize your progress. üí°",timestamp:e-36e5,read:!1},{message:"Alert: Your emergency fund reached $5,000! üéä",timestamp:e-18e5,read:!1},{message:"Update: Your credit score improved by 15 points! üìà",timestamp:e-9e5,read:!0}]}().map(e=>l(t,{message:e.message,timestamp:m.fromMillis(e.timestamp),read:e.read,category:"info"}));return await Promise.all(e),!0}}catch(t){}return!1}function p(){try{const e=localStorage.getItem("local_test_notifications");if(e)return JSON.parse(e)}catch(n){}const e=window.getLocalTestData&&window.getLocalTestData("notifications")||window.LOCAL_TEST_DATA?.notifications||[];return t=e,JSON.parse(JSON.stringify(t));var t}function g(e){try{localStorage.setItem("local_test_notifications",JSON.stringify(e))}catch(t){}}function y(t="all"){const n=document.getElementById("notifications"),i=document.getElementById("loading"),a=p();if(i.style.display="none",n.style.display="block",e=a.map((e,t)=>({id:e.id||`local-${t}-${Date.now()}`,message:e.message||"Notification",timestamp:e.timestamp||Date.now(),read:void 0!==e.read&&e.read,category:e.category||"info"})),b(),0===e.length)return void(n.innerHTML='\n          <div class="empty-state">\n            <div style="font-size: 4em; margin-bottom: 20px;">üîî</div>\n            <h3>No notifications found</h3>\n            <p>You\'re all caught up! New notifications will appear here.</p>\n          </div>\n        ');const s=e.filter(e=>"unread"===t?!e.read:"read"!==t||e.read);0!==s.length?(n.innerHTML="",s.forEach(e=>{const t=document.createElement("div");t.className="notification "+(e.read?"":"unread");const i=v(e.message||""),a=w(e.message||""),s=(o=e)&&o.timestamp?"number"==typeof o.timestamp?new Date(o.timestamp).toLocaleString():o.timestamp.seconds?new Date(1e3*o.timestamp.seconds).toLocaleString():new Date(o.timestamp).toLocaleString():"Just now";var o;t.innerHTML=`\n          <div class="notification-header">\n            <div>\n              <span class="notification-type ${i}">${i.replace("type-","")}</span>\n              <div class="notification-message">\n                <span style="font-size: 1.2em; margin-right: 8px;">${a}</span>\n                ${e.message||"Notification"}\n              </div>\n            </div>\n          </div>\n          <div class="notification-time">${s}</div>\n          <div class="notification-actions">\n            ${e.read?"":`<button class="btn btn-primary" onclick="markAsRead('${e.id}')">‚úÖ Mark as Read</button>`}\n            <button class="btn btn-secondary" onclick="deleteNotification('${e.id}')">üóëÔ∏è Delete</button>\n          </div>\n        `,n.appendChild(t)})):n.innerHTML=`\n          <div class="empty-state">\n            <div style="font-size: 4em; margin-bottom: 20px;">üîî</div>\n            <h3>No ${"unread"===t?"unread":"read"===t?"read":""} notifications found</h3>\n            <p>Try changing the filter to see more notifications.</p>\n          </div>\n        `}function h(e,t="success"){const n=document.getElementById("toast");n.innerText=e,n.className=`toast ${t}`,n.style.visibility="visible",n.style.opacity="1",setTimeout(()=>{n.style.opacity="0",n.style.visibility="hidden"},3e3)}function v(e){return e.includes("success")||e.includes("completed")||e.includes("achieved")?"type-success":e.includes("warning")||e.includes("caution")||e.includes("attention")?"type-warning":e.includes("error")||e.includes("failed")||e.includes("problem")?"type-error":"type-info"}function w(e){return e.includes("goal")||e.includes("target")?"üéØ":e.includes("payment")||e.includes("debt")?"üí≥":e.includes("budget")||e.includes("spending")?"üí∞":e.includes("savings")||e.includes("saved")?"üíµ":e.includes("reminder")||e.includes("due")?"‚è∞":e.includes("welcome")||e.includes("account")?"üëã":"üì¢"}function b(){const t=e.length,n=e.filter(e=>!e.read).length,i=t-n;document.getElementById("totalNotifications").textContent=t,document.getElementById("unreadNotifications").textContent=n,document.getElementById("readNotifications").textContent=i}async function E(n){const i=document.getElementById("notifications"),a=document.getElementById("loading"),l=document.getElementById("notifFilter").value;if(i.innerHTML="",a.style.display="block",i.style.display="block",t)y(l);else try{if(u(n)){const e=o(db,"users",n.uid,"notifications");if((await r(e)).empty&&await f(n))return void(await E(n))}let t=s(o(db,"users",n.uid,"notifications"),c("timestamp","desc"));"unread"===l?t=s(t,d("read","==",!1)):"read"===l&&(t=s(t,d("read","==",!0)));const m=await r(t);if(a.style.display="none",i.style.display="block",e=[],m.forEach(t=>{e.push({id:t.id,...t.data()})}),b(),0===e.length)return void(i.innerHTML='\n            <div class="empty-state">\n              <div style="font-size: 4em; margin-bottom: 20px;">üîî</div>\n              <h3>No notifications found</h3>\n              <p>You\'re all caught up! New notifications will appear here.</p>\n            </div>\n          ');const p=e.filter(e=>"unread"===l?!e.read:"read"!==l||e.read);if(0===p.length)return void(i.innerHTML=`\n            <div class="empty-state">\n              <div style="font-size: 4em; margin-bottom: 20px;">üîî</div>\n              <h3>No ${"unread"===l?"unread":"read"===l?"read":""} notifications found</h3>\n              <p>Try changing the filter to see more notifications.</p>\n            </div>\n          `);i.innerHTML="",p.forEach(e=>{const t=document.createElement("div");t.className="notification "+(e.read?"":"unread");const n=v(e.message),a=w(e.message),s=e.timestamp?new Date(1e3*e.timestamp.seconds).toLocaleString():"Just now";t.innerHTML=`\n            <div class="notification-header">\n              <div>\n                <span class="notification-type ${n}">${n.replace("type-","")}</span>\n                <div class="notification-message">\n                  <span style="font-size: 1.2em; margin-right: 8px;">${a}</span>\n                  ${e.message}\n                </div>\n              </div>\n            </div>\n            <div class="notification-time">${s}</div>\n            <div class="notification-actions">\n              ${e.read?"":`<button class="btn btn-primary" onclick="markAsRead('${e.id}')">‚úÖ Mark as Read</button>`}\n              <button class="btn btn-secondary" onclick="deleteNotification('${e.id}')">üóëÔ∏è Delete</button>\n            </div>\n          `,i.appendChild(t)})}catch(m){a.style.display="none",i.innerHTML='\n          <div class="empty-state">\n            <div style="font-size: 4em; margin-bottom: 20px;">‚ùå</div>\n            <h3>Error loading notifications</h3>\n            <p>Please try refreshing the page.</p>\n          </div>\n        '}}window.markAsRead=async function(e){const a=auth.currentUser;if(a||t){if(t){const t=p(),n=t.findIndex(t=>t.id===e);return void(n>=0&&(t[n].read=!0,g(t),h("Notification marked as read","success"),y(document.getElementById("notifFilter").value)))}try{const t=n(db,"users",a.uid,"notifications",e);await i(t,{read:!0}),h("Notification marked as read","success"),E(a)}catch(s){h("Error marking notification as read","error")}}},window.deleteNotification=async function(e){const i=auth.currentUser;if((i||t)&&confirm("Are you sure you want to delete this notification?")){if(t)return g(p().filter(t=>t.id!==e)),h("Notification deleted","success"),void y(document.getElementById("notifFilter").value);try{const t=n(db,"users",i.uid,"notifications",e);await a(t),h("Notification deleted","success"),E(i)}catch(s){h("Error deleting notification","error")}}},window.markAllAsRead=async function(){const a=auth.currentUser;if(a||t){if(t){const e=p().map(e=>({...e,read:!0}));return g(e),h(`${e.length} notifications marked as read`,"success"),void y(document.getElementById("notifFilter").value)}try{const t=e.filter(e=>!e.read),s=t.map(e=>{const t=n(db,"users",a.uid,"notifications",e.id);return i(t,{read:!0})});await Promise.all(s),h(`${t.length} notifications marked as read`,"success"),E(a)}catch(s){h("Error marking notifications as read","error")}}},window.clearAllNotifications=async function(){const e=auth.currentUser;if((e||t)&&confirm("Are you sure you want to delete ALL notifications? This action cannot be undone.")){if(t)return g([]),h("All notifications cleared","success"),void y(document.getElementById("notifFilter").value);try{const t=s(o(db,"users",e.uid,"notifications")),i=(await r(t)).docs.map(t=>a(n(db,"users",e.uid,"notifications",t.id)));await Promise.all(i),h("All notifications cleared","success"),E(e)}catch(i){h("Error clearing notifications","error")}}},document.getElementById("notifFilter").addEventListener("change",()=>{const e=auth.currentUser;e&&E(e),t&&y(document.getElementById("notifFilter").value)}),(async()=>{try{const{auth:e}=await waitForAuth(1e4);window.auth=e,e.onAuthStateChanged(e=>{e?E(e):t?y(document.getElementById("notifFilter").value):(document.getElementById("notifications").innerHTML='\n              <div class="empty-state">\n                <div style="font-size: 4em; margin-bottom: 20px;">üîê</div>\n                <h3>Please log in</h3>\n                <p>You need to be logged in to view your notifications.</p>\n                <a href="/src/pages/auth/login.html" class="btn btn-primary" style="margin-top: 20px;">Login</a>\n              </div>\n            ',document.getElementById("loading").style.display="none")})}catch(e){t?y(document.getElementById("notifFilter")?.value||"all"):(document.getElementById("notifications").innerHTML='\n            <div class="empty-state">\n              <div style="font-size: 4em; margin-bottom: 20px;">üîê</div>\n              <h3>Please log in</h3>\n              <p>You need to be logged in to view your notifications.</p>\n              <a href="/src/pages/auth/login.html" class="btn btn-primary" style="margin-top: 20px;">Login</a>\n            </div>\n          ',document.getElementById("loading")&&(document.getElementById("loading").style.display="none"))}})()}}});
